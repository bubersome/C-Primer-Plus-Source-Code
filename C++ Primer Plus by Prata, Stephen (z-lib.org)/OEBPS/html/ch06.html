<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>6. Branching Statements and Logical Operators</title>
<link rel="stylesheet" type="text/css" href="0132781174.css"/>
<link rel="stylesheet" type="application/vnd.adobe-page-template+xml" href="page-template.xpgt"/>
</head>
<body>
<h2 id="ch06">6. Branching Statements and Logical Operators</h2>
<p><a id="page_253"/>In this chapter you&#8217;ll learn about the following:</p>
<p class="indenthandingB">&#8226; The <code>if</code> statement</p>
<p class="indenthandingB">&#8226; The <code>if else</code> statement</p>
<p class="indenthandingB">&#8226; Logical operators: <code>&#38;&#38;</code>, <code>||</code>, and <code>!</code></p>
<p class="indenthandingB">&#8226; The <code>cctype</code> library of character functions</p>
<p class="indenthandingB">&#8226; The conditional operator: <code>?:</code></p>
<p class="indenthandingB">&#8226; The <code>switch</code> statement</p>
<p class="indenthandingB">&#8226; The <code>continue</code> and <code>break</code> statements</p>
<p class="indenthandingB">&#8226; Number-reading loops</p>
<p class="indenthandingB">&#8226; Basic file input/output</p>
<p>One of the keys to designing intelligent programs is to give them the ability to make decisions. <a href="ch05.html#ch05">Chapter 5</a>, &#8220;<a href="ch05.html#ch05">Loops and Relational Expressions</a>,&#8221; shows one kind of decision making&#8212;looping&#8212;in which a program decides whether to continue looping. This chapter investigates how C++ lets you use branching statements to decide among alternative actions. Which vampire-protection scheme (garlic or cross) should the program use? What menu choice has the user selected? Did the user enter a zero? C++ provides the <code>if</code> and <code>switch</code> statements to implement decisions, and they are this chapter&#8217;s main topics. This chapter also looks at the conditional operator, which provides another way to make a choice, and the logical operators, which let you combine two tests into one. Finally, the chapter takes a first look at file input/output.</p>
<h3 id="ch06lev1sec1">The <code>if</code> Statement</h3>
<p><a id="page_254"/>When a C++ program must choose whether to take a particular action, you usually implement the choice with an <code>if</code> statement. The <code>if</code> comes in two forms: <code>if</code> and <code>if else</code>. Let&#8217;s investigate the simple <code>if</code> first. It&#8217;s modeled after ordinary English, as in &#8220;If you have a Captain Cookie card, you get a free cookie.&#8221; The <code>if</code> statement directs a program to execute a statement or statement block if a test condition is true and to skip that statement or block if the condition is false. Thus, an <code>if</code> statement lets a program decide whether a particular statement should be executed.</p>
<p>The syntax for the <code>if</code> statement is similar to the that of the <code>while</code> syntax:</p>
<p class="programlisting">if (<span class="EmpItalic">test-condition</span>)<br/>&#160;&#160;&#160;&#160;<span class="EmpItalic">statement</span></p>
<p>A true <em><code>test-condition</code></em> causes the program to execute <em><code>statement</code></em>, which can be a single statement or a block. A false <em><code>test-condition</code></em> causes the program to skip <em><code>statement</code></em> (see <a href="#ch06fig01">Figure 6.1</a>). As with loop test conditions, an <code>if</code> test condition is type cast to a <code>bool</code> value, so zero becomes <code>false</code> and nonzero becomes <code>true</code>. The entire <code>if</code> construction counts as a single statement.</p>
<p class="caption"><a id="ch06fig01"/><strong>Figure 6.1. The structure of <code>if</code> statements.</strong></p>
<p class="image"><img src="graphics/06fig01.jpg" alt="Image"/></p>
<p>Most often, <em><code>test-condition</code></em> is a relational expression such as those used to control loops. Suppose, for example, that you want a program that counts the spaces in the input as well as the total number of characters. You can use <code>cin.get(char)</code> in a <code>while</code> loop to <a id="page_255"/>read the characters and then use an <code>if</code> statement to identify and count the space characters. <a href="#ch06ex01">Listing 6.1</a> does just that, using the period (<code>.</code>) to recognize the end of a sentence.</p>
<p class="caption1"><a id="ch06ex01"/><strong>Listing 6.1. <code>if.cpp</code></strong></p><hr/>
<p class="programlisting1">// if.cpp -- using the if statement<br/>#include &lt;iostream&gt;<br/>int main()<br/>{<br/>&#160;&#160;&#160;&#160;using std::cin;&#160;&#160;&#160;&#160;&#160;// using declarations<br/>&#160;&#160;&#160;&#160;using std::cout;<br/>&#160;&#160;&#160;&#160;char ch;<br/>&#160;&#160;&#160;&#160;int spaces = 0;<br/>&#160;&#160;&#160;&#160;int total = 0;<br/>&#160;&#160;&#160;&#160;cin.get(ch);<br/>&#160;&#160;&#160;&#160;while (ch != '.')&#160;&#160;&#160;// quit at end of sentence<br/>&#160;&#160;&#160;&#160;{<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if (ch == ' ')&#160;&#160;// check if ch is a space<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;++spaces;<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;++total;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// done every time<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cin.get(ch);<br/>&#160;&#160;&#160;&#160;}<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; spaces &lt;&lt; " spaces, " &lt;&lt; total;<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; " characters total in sentence\n";<br/>&#160;&#160;&#160;&#160;return 0;<br/>}</p><hr/>
<p>Here&#8217;s some sample output from the program in <a href="#ch06ex01">Listing 6.1</a>:</p>
<p class="programlisting"><span class="EmpStrong">The balloonist was an airhead</span><br/><span class="EmpStrong">with lofty goals.</span><br/>6 spaces, 46 characters total in sentence</p>
<p>As the comments in <a href="#ch06ex01">Listing 6.1</a> indicate, the ++<code>spaces;</code> statement is executed only when <code>ch</code> is a space. Because it is outside the <code>if</code> statement, the ++<code>total;</code> statement is executed in every loop cycle. Note that the total count includes the newline character that is generated by pressing Enter.</p>
<h4 id="ch06lev2sec1">The <code>if else</code> Statement</h4>
<p>Whereas an <code>if</code> statement lets a program decide whether a <em>particular</em> statement or block is executed, an <code>if else</code> statement lets a program decide which of <em>two</em> statements or blocks is executed. It&#8217;s an invaluable statement for creating alternative courses of action. The C++ <code>if else</code> statement is modeled after simple English, as in &#8220;If you have a Captain Cookie card, you get a Cookie Plus Plus, else you just get a Cookie d&#8217;Ordinaire.&#8221; The <code>if else</code> statement has this general form:</p>
<p class="programlisting"><a id="page_256"/>if (<span class="EmpItalic">test-condition</span>)<br/>&#160;&#160;&#160;&#160;<span class="EmpItalic">statement1</span><br/>else<br/>&#160;&#160;&#160;&#160;<span class="EmpItalic">statement2</span></p>
<p>If <em><code>test-condition</code></em> is <code>true</code>, or nonzero, the program executes <em><code>statement1</code></em> and skips over <em><code>statement2</code></em>. Otherwise, when <em><code>test-condition</code></em> is <code>false</code>, or zero, the program skips <em><code>statement1</code></em> and executes <em><code>statement2</code></em> instead. So the following code fragment prints the first message if <code>answer</code> is <code>1492</code> and prints the second message otherwise:</p>
<p class="programlisting">if (answer == 1492)<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "That's right!\n";<br/>else<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "You'd better review Chapter 1 again.\n";</p>
<p>Each statement can be either a single statement or a statement block delimited by braces (see <a href="#ch06fig02">Figure 6.2</a>). The entire <code>if else</code> construct counts syntactically as a single statement.</p>
<p class="caption"><a id="ch06fig02"/><strong>Figure 6.2. The structure of <code>if else</code> statements.</strong></p>
<p class="image"><img src="graphics/06fig02.jpg" alt="Image"/></p>
<p>For example, suppose you want to alter incoming text by scrambling the letters while keeping the newline character intact. In that case, each line of input is converted to an output line of equal length. This means you want the program to take one course of action for newline characters and a different course of action for all other characters. As <a href="#ch06ex02">Listing 6.2</a> shows, <code>if else</code> makes this task easy. The listing also illustrates the <code>std::</code> qualifier, one of the alternatives to a <code>using</code> directive.</p>
<p class="caption1"><a id="page_257"/><a id="ch06ex02"/><strong>Listing 6.2. <code>ifelse.cpp</code></strong></p><hr/>
<p class="programlisting1">// ifelse.cpp -- using the if else statement<br/>#include &lt;iostream&gt;<br/>int main()<br/>{<br/>&#160;&#160;&#160;&#160;char ch;<br/><br/>&#160;&#160;&#160;&#160;std::cout &lt;&lt; "Type, and I shall repeat.\n";<br/>&#160;&#160;&#160;&#160;std::cin.get(ch);<br/>&#160;&#160;&#160;&#160;while (ch != '.')<br/>&#160;&#160;&#160;&#160;{<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if (ch == '\n')<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;std::cout &lt;&lt; ch;&#160;&#160;&#160;&#160;&#160;// done if newline<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;std::cout &lt;&lt; ++ch;&#160;&#160;&#160;// done otherwise<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;std::cin.get(ch);<br/>&#160;&#160;&#160;&#160;}<br/>// try ch + 1 instead of ++ch for interesting effect<br/>&#160;&#160;&#160;&#160;std::cout &lt;&lt; "\nPlease excuse the slight confusion.\n";<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;//&#160;&#160;std::cin.get();<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;//&#160;&#160;std::cin.get();<br/>&#160;&#160;&#160;&#160;return 0;<br/>}</p><hr/>
<p>Here&#8217;s some sample output from the program in <a href="#ch06ex02">Listing 6.2</a>:</p>
<p class="programlisting">Type, and I shall repeat.<br/><span class="EmpStrong">An ineffable joy suffused me as I beheld</span><br/>Bo!jofggbcmf!kpz!tvggvtfe!nf!bt!J!cfifme<br/><span class="EmpStrong">the wonders of modern computing.</span><br/>uif!xpoefst!pg!npefso!dpnqvujoh<br/>Please excuse the slight confusion.</p>
<p>Note that one of the comments in <a href="#ch06ex02">Listing 6.2</a> suggests that changing <code>++ch</code> to <code>ch+1</code> has an interesting effect. Can you deduce what it will be? If not, try it out and then see if you can explain what&#8217;s happening. (Hint: Think about how <code>cout</code> handles different types.)</p>
<h4 id="ch06lev2sec2">Formatting <code>if else</code> Statements</h4>
<p>Keep in mind that the two alternatives in an <code>if else</code> statement must be single statements. If you need more than one statement, you must use braces to collect them into a single block statement. Unlike some languages, such as BASIC and FORTRAN, C++ does not automatically consider everything between <code>if</code> and <code>else</code> a block, so you have to use braces to make the statements a block. The following code, for example, produces a compiler error:</p>
<p class="programlisting"><a id="page_258"/>if (ch == 'Z')<br/>&#160;&#160;&#160;&#160;zorro++;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// if ends here<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "Another Zorro candidate\n";<br/>else&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// wrong<br/>&#160;&#160;&#160;&#160;dull++;<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "Not a Zorro candidate\n";</p>
<p>The compiler sees it as a simple <code>if</code> statement that ends with the <code>zorro++;</code> statement.</p>
<p>Then there is a <code>cout</code> statement. So far, so good. But then there is what the compiler perceives as an unattached <code>else</code>, and that is flagged as a syntax error.</p>
<p>You add braces to group statements into a single statement block:</p>
<p class="programlisting">if (ch == 'Z')<br/>{&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// if true block<br/>&#160;&#160;&#160;&#160;zorro++;<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "Another Zorro candidate\n";<br/>}<br/>else<br/>{&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// if false block<br/>&#160;&#160;&#160;&#160;dull++;<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "Not a Zorro candidate\n";<br/>}</p>
<p>Because C++ is a free-form language, you can arrange the braces as you like, as long as they enclose the statements. The preceding code shows one popular format. Here&#8217;s another:</p>
<p class="programlisting">if (ch == 'Z') {<br/>&#160;&#160;&#160;&#160;zorro++;<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "Another Zorro candidate\n";<br/>&#160;&#160;&#160;&#160;}<br/>else {<br/>&#160;&#160;&#160;&#160;dull++;<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "Not a Zorro candidate\n";<br/>&#160;&#160;&#160;&#160;}</p>
<p>The first form emphasizes the block structure for the statements, whereas the second form more closely ties the blocks to the keywords <code>if</code> and <code>else</code>. Either style is clear and consistent and should serve you well; however, you may encounter an instructor or employer with strong and specific views on the matter.</p>
<h4 id="ch06lev2sec3">The <code>if else if else</code> Construction</h4>
<p>Computer programs, like life, might present you with a choice of more than two selections. You can extend the C++ <code>if else</code> statement to meet such a need. As you&#8217;ve seen, the <code>else</code> should be followed by a single statement, which can be a block. Because an <code>if else</code> statement itself is a single statement, it can follow an <code>else</code>:</p>
<p class="programlisting"><a id="page_259"/>if (ch == 'A')<br/>&#160;&#160;&#160;&#160;a_grade++;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// alternative # 1<br/>else<br/>&#160;&#160;&#160;&#160;if (ch == 'B')&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// alternative # 2<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;b_grade++;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// subalternative # 2a<br/>&#160;&#160;&#160;&#160;else<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;soso++;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// subalternative # 2b</p>
<p>If <code>ch</code> is not <code>'A'</code>, the program goes to the <code>else</code>. There, a second <code>if else</code> subdivides that alternative into two more choices. C++&#8217;s free formatting enables you to arrange these elements into an easier-to-read format:</p>
<p class="programlisting">if (ch == 'A')<br/>&#160;&#160;&#160;&#160;a_grade++;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// alternative # 1<br/>else if (ch == 'B')<br/>&#160;&#160;&#160;&#160;b_grade++;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// alternative # 2<br/>else<br/>&#160;&#160;&#160;&#160;soso++;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// alternative # 3</p>
<p>This looks like a new control structure&#8212;an <code>if else if else</code> structure. But actually it is one <code>if else</code> contained within a second. This revised format looks much cleaner, and it enables you to skim through the code to pick out the different alternatives. This entire construction still counts as one statement.</p>
<p><a href="#ch06ex03">Listing 6.3</a> uses this preferred formatting to construct a modest quiz program.</p>
<p class="caption1"><a id="ch06ex03"/><strong>Listing 6.3. <code>ifelseif.cpp</code></strong></p><hr/>
<p class="programlisting1">// ifelseif.cpp -- using if else if else<br/>#include &lt;iostream&gt;<br/>const int Fave = 27;<br/>int main()<br/>{<br/>&#160;&#160;&#160;&#160;using namespace std;<br/>&#160;&#160;&#160;&#160;int n;<br/><br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "Enter a number in the range 1-100 to find ";<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "my favorite number: ";<br/>&#160;&#160;&#160;&#160;do<br/>&#160;&#160;&#160;&#160;{<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cin &gt;&gt; n;<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if (n &lt; Fave)<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cout &lt;&lt; "Too low -- guess again: ";<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else if (n &gt; Fave)<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cout &lt;&lt; "Too high -- guess again: ";<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cout &lt;&lt; Fave &lt;&lt; " is right!\n";<br/>&#160;&#160;&#160;&#160;} while (n != Fave);<br/>&#160;&#160;&#160;&#160;return 0;<br/>}</p><hr/>
<p><a id="page_260"/>Here&#8217;s some sample output from the program in <a href="#ch06ex03">Listing 6.3</a>:</p>
<p class="programlisting">Enter a number in the range 1-100 to find my favorite number: <span class="EmpStrong">50</span><br/>Too high -- guess again: <span class="EmpStrong">25</span><br/>Too low -- guess again: <span class="EmpStrong">37</span><br/>Too high -- guess again: <span class="EmpStrong">31</span><br/>Too high -- guess again: <span class="EmpStrong">28</span><br/>Too high -- guess again: <span class="EmpStrong">27</span><br/>27 is right!</p>
<div class="sidebar"><hr/>
<p class="title"><a id="ch06sb01"/>Conditional Operators and Bug Prevention</p>
<p class="sidebarpara">Many programmers reverse the more intuitive expression <em><code>variable</code></em> <code>==</code> <em><code>value</code></em> to <em><code>value</code></em> <code>==</code> <em><code>variable</code></em> in order to catch errors where the equality is mistyped as an assignment operator. For example, entering the conditional as follows is valid and will work properly:</p>
<p class="programlistingB">if (3 == myNumber)</p>
<p class="sidebarpara">However, if you happen to mistype as follows, the compiler will generate an error message because it believes you are attempting to assign a value to a literal (3 always equals 3 and can&#8217;t be assigned another value):</p>
<p class="programlistingB">if (3 = myNumber)</p>
<p class="sidebarpara">Suppose you made a similar mistake, using the former notation:</p>
<p class="programlistingB">if (myNumber = 3)</p>
<p class="sidebarpara">The compiler would simply assign the value <code>3</code> to <code>myNumber</code>, and the block within the <code>if</code> would run&#8212;a very common error, and a difficult error to find. (However, many compilers will issue a warning, which you would be wise to heed.) As a general rule, writing code that allows the compiler to find errors is much easier than repairing the causes of mysterious faulty results.</p>
<hr/></div>
<h3 id="ch06lev1sec2">Logical Expressions</h3>
<p>Often you must test for more than one condition. For example, for a character to be a lowercase letter, its value must be greater than or equal to <code>'a'</code> and less than or equal to <code>'z'</code>. Or, if you ask a user to respond with a <strong><code>y</code></strong> or an <strong><code>n</code></strong>, you want to accept uppercase (<strong><code>Y</code></strong> and <strong><code>N</code></strong>) as well as lowercase. To meet this kind of need, C++ provides three logical operators to combine or modify existing expressions. The operators are logical OR, written <code>||</code>; logical AND, written <code>&#38;&#38;</code>; and logical NOT, written <code>!</code>. Let&#8217;s examine them now.</p>
<h4 id="ch06lev2sec4">The Logical OR Operator: <code>||</code></h4>
<p>In English, the word <em>or</em> can indicate when one or both of two conditions satisfy a requirement. For example, you can go to the MegaMicro company picnic if you <em>or</em> your spouse work for MegaMicro, Inc. The C++ equivalent is the logical OR operator, written <code>||</code>. This operator combines two expressions into one. If either or both of the original <a id="page_261"/>expressions is <code>true</code>, or nonzero, the resulting expression has the value <code>true</code>. Otherwise, the expression has the value <code>false</code>. Here are some examples:</p>
<p class="programlisting">5 == 5 || 5 == 9&#160;&#160;&#160;// true because first expression is true<br/>5 &gt; 3 || 5 &gt; 10&#160;&#160;&#160;&#160;// true because first expression is true<br/>5 &gt; 8 || 5 &lt; 10&#160;&#160;&#160;&#160;// true because second expression is true<br/>5 &lt; 8 || 5 &gt; 2&#160;&#160;&#160;&#160;&#160;// true because both expressions are true<br/>5 &gt; 8 || 5 &lt; 2&#160;&#160;&#160;&#160;&#160;// false because both expressions are false</p>
<p>Because the <code>||</code> has a lower precedence than the relational operators, you don&#8217;t need to use parentheses in these expressions. <a href="#ch06table01">Table 6.1</a> summarizes how the <code>||</code> operator works.</p>
<p class="caption"><a id="ch06table01"/><strong>Table 6.1. The <code>||</code> Operator</strong></p>
<p class="image"><img src="graphics/06tab01.jpg" alt="Image"/></p>
<p>C++ provides that the <code>||</code> operator is a <em>sequence point</em>. That is, any value changes indicated on the left side take place before the right side is evaluated. (Or in the newer parlance of C++11, the subexpression to the left of the operator is sequenced before the subexpression to the right.) For example, consider the following expression:</p>
<p class="programlisting">i++ &lt; 6 || i == j</p>
<p>Suppose <code>i</code> originally has the value <code>10</code>. By the time the comparison with <code>j</code> takes place, <code>i</code> has the value <code>11</code>. Also C++ won&#8217;t bother evaluating the expression on the right if the expression on the left is true, for it only takes one true expression to make the whole logical expression true. (The semicolon and the comma operator, recall, are also sequence points.)</p>
<p><a href="#ch06ex04">Listing 6.4</a> uses the <code>||</code> operator in an <code>if</code> statement to check for both uppercase and lowercase versions of a character. Also it uses C++&#8217;s string concatenation feature (see <a href="ch04.html#ch04">Chapter 4</a>, &#8220;<a href="ch04.html#ch04">Compound Types</a>&#8221;) to spread a single string over three lines.</p>
<p class="caption1"><a id="ch06ex04"/><strong>Listing 6.4. <code>or.cpp</code></strong></p><hr/>
<p class="programlisting1">// or.cpp -- using the logical OR operator<br/>#include &lt;iostream&gt;<br/>int main()<br/>{<br/>&#160;&#160;&#160;&#160;using namespace std;<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "This program may reformat your hard disk\n"<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;"and destroy all your data.\n"<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;"Do you wish to continue? &lt;y/n&gt; ";<br/>&#160;&#160;&#160;&#160;char ch;<br/>&#160;&#160;&#160;&#160;cin &gt;&gt; ch;<br/>&#160;&#160;&#160;&#160;if (ch == 'y' || ch == 'Y')&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// y or Y<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cout &lt;&lt; "You were warned!\a\a\n";<br/>&#160;&#160;&#160;&#160;else if (ch == 'n' || ch == 'N')&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// n or N<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cout &lt;&lt; "A wise choice ... bye\n";<br/>&#160;&#160;&#160;&#160;else<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "That wasn't a y or n! Apparently you "<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;"can't follow\ninstructions, so "<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;"I'll trash your disk anyway.\a\a\a\n";<br/>&#160;&#160;&#160;&#160;return 0;<br/>}</p><hr/>
<p><a id="page_262"/>(The program doesn&#8217;t really carry out any threats.) Here is a sample run of the program in <a href="#ch06ex04">Listing 6.4</a>:</p>
<p class="programlisting">This program may reformat your hard disk<br/>and destroy all your data.<br/>Do you wish to continue? &lt;y/n&gt; <span class="EmpStrong">N</span><br/>A wise choice ... bye</p>
<p>The program reads just one character, so only the first character in the response matters. That means the user could have input <strong><code>NO!</code></strong> instead of <strong><code>N</code></strong>. The program would just read the <strong><code>N</code></strong>. But if the program tried to read more input later, it would start at the <strong><code>O</code></strong>.</p>
<h4 id="ch06lev2sec5">The Logical AND Operator: <code>&#38;&#38;</code></h4>
<p>The logical AND operator, written <code>&#38;&#38;</code>, also combines two expressions into one. The resulting expression has the value <code>true</code> only if <em>both</em> of the original expressions are <code>true</code>. Here are some examples:</p>
<p class="programlisting">5 == 5 &#38;&#38; 4 == 4&#160;&#160;&#160;// true because both expressions are true<br/>5 == 3 &#38;&#38; 4 == 4&#160;&#160;&#160;// false because first expression is false<br/>5 &gt; 3 &#38;&#38; 5 &gt; 10&#160;&#160;&#160;&#160;// false because second expression is false<br/>5 &gt; 8 &#38;&#38; 5 &lt; 10&#160;&#160;&#160;&#160;// false because first expression is false<br/>5 &lt; 8 &#38;&#38; 5 &gt; 2&#160;&#160;&#160;&#160;&#160;// true because both expressions are true<br/>5 &gt; 8 &#38;&#38; 5 &lt; 2&#160;&#160;&#160;&#160;&#160;// false because both expressions are false</p>
<p>Because the <code>&#38;&#38;</code> has a lower precedence than the relational operators, you don&#8217;t need to use parentheses in these expressions. Like the <code>||</code> operator, the <code>&#38;&#38;</code> operator acts as a sequence point, so the left side is evaluated, and any side effects are carried out before the right side is evaluated. If the left side is false, the whole logical expression must be false, so C++ doesn&#8217;t bother evaluating the right side in that case. <a href="#ch06table02">Table 6.2</a> summarizes how the <code>&#38;&#38;</code> operator works.</p>
<p class="caption"><a id="page_263"/><a id="ch06table02"/><strong>Table 6.2. The <em><code>&#38;&#38;</code></em> Operator</strong></p>
<p class="image"><img src="graphics/06tab02.jpg" alt="Image"/></p>
<p><a href="#ch06ex05">Listing 6.5</a> shows how to use <code>&#38;&#38;</code> to cope with a common situation, terminating a <code>while</code> loop, for two different reasons. In the listing, a <code>while</code> loop reads values into an array. One test (<code>i &lt; ArSize</code>) terminates the loop when the array is full. The second test (<code>temp &gt;= 0</code>) gives the user the option of quitting early by entering a negative number. The program uses the <code>&#38;&#38;</code> operator to combine the two tests into a single condition. The program also uses two <code>if</code> statements, an <code>if else</code> statement, and a <code>for</code> loop, so it demonstrates several topics from this chapter and <a href="ch05.html#ch05">Chapter 5</a>.</p>
<p class="caption1"><a id="ch06ex05"/><strong>Listing 6.5. <code>and.cpp</code></strong></p><hr/>
<p class="programlisting1">// and.cpp -- using the logical AND operator<br/>#include &lt;iostream&gt;<br/>const int ArSize = 6;<br/>int main()<br/>{<br/>&#160;&#160;&#160;&#160;using namespace std;<br/>&#160;&#160;&#160;&#160;float naaq[ArSize];<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "Enter the NAAQs (New Age Awareness Quotients) "<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;&lt; "of\nyour neighbors. Program terminates "<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;&lt; "when you make\n" &lt;&lt; ArSize &lt;&lt; " entries "<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;&lt; "or enter a negative value.\n";<br/><br/>&#160;&#160;&#160;&#160;int i = 0;<br/>&#160;&#160;&#160;&#160;float temp;<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "First value: ";<br/>&#160;&#160;&#160;&#160;cin &gt;&gt; temp;<br/>&#160;&#160;&#160;&#160;while (i &lt; ArSize &#38;&#38; temp &gt;= 0) // 2 quitting criteria<br/>&#160;&#160;&#160;&#160;{<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;naaq[i] = temp;<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;++i;<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if (i &lt; ArSize)&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// room left in the array,<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;{<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cout &lt;&lt; "Next value: ";<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cin &gt;&gt; temp;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// so get next value<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;}<br/>&#160;&#160;&#160;&#160;}<br/>&#160;&#160;&#160;&#160;if (i == 0)<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cout &lt;&lt; "No data--bye\n";<br/>&#160;&#160;&#160;&#160;else<br/>&#160;&#160;&#160;&#160;{<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cout &lt;&lt; "Enter your NAAQ: ";<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;float you;<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cin &gt;&gt; you;<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;int count = 0;<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;for (int j = 0; j &lt; i; j++)<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if (naaq[j] &gt; you)<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;++count;<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cout &lt;&lt; count;<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cout &lt;&lt; " of your neighbors have greater awareness of\n"<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;&lt; "the New Age than you do.\n";<br/>&#160;&#160;&#160;&#160;}<br/>&#160;&#160;&#160;&#160;return 0;<br/>}</p><hr/>
<p><a id="page_264"/>Note that the program in <a href="#ch06ex05">Listing 6.5</a> places input into the temporary variable <code>temp</code>. Only after it verifies that the input is valid does the program assign the value to the array.</p>
<p>Here are a couple of sample runs of the program. One terminates after six entries:</p>
<p class="programlisting">Enter the NAAQs (New Age Awareness Quotients) of<br/>your neighbors. Program terminates when you make<br/>6 entries or enter a negative value.<br/>First value: <span class="EmpStrong">28</span><br/>Next value: <span class="EmpStrong">72</span><br/>Next value: <span class="EmpStrong">15</span><br/>Next value: <span class="EmpStrong">6</span><br/>Next value: <span class="EmpStrong">130</span><br/>Next value: <span class="EmpStrong">145</span><br/>Enter your NAAQ: <span class="EmpStrong">50</span><br/>3 of your neighbors have greater awareness of<br/>the New Age than you do.</p>
<p>The second run terminates after a negative value is entered:</p>
<p class="programlisting">Enter the NAAQs (New Age Awareness Quotients) of<br/>your neighbors. Program terminates when you make<br/>6 entries or enter a negative value.<br/>First value: <span class="EmpStrong">123</span><br/>Next value: <span class="EmpStrong">119</span><br/>Next value: <span class="EmpStrong">4</span><br/>Next value: <span class="EmpStrong">89</span><br/>Next value: <span class="EmpStrong">-1</span><br/>Enter your NAAQ: <span class="EmpStrong">123.031</span><br/>0 of your neighbors have greater awareness of<br/>the New Age than you do.</p>
<h5 id="ch06lev3sec1">Program Notes</h5>
<p><a id="page_265"/>The following is the input part of the program in <a href="#ch06ex05">Listing 6.5</a>:</p>
<p class="programlisting">cin &gt;&gt; temp;<br/>while (i &lt; ArSize &#38;&#38; temp &gt;= 0) // 2 quitting criteria<br/>{<br/>&#160;&#160;&#160;&#160;naaq[i] = temp;<br/>&#160;&#160;&#160;&#160;++i;<br/>&#160;&#160;&#160;&#160;if (i &lt; ArSize)&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// room left in the array,<br/>&#160;&#160;&#160;&#160;{<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cout &lt;&lt; "Next value: ";<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cin &gt;&gt; temp;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// so get next value<br/>&#160;&#160;&#160;&#160;}<br/>}</p>
<p>The program begins by reading the first input value into a temporary variable called <code>temp</code>. Then the <code>while</code> test condition checks whether there is still room left in the array (<code>i &lt; ArSize</code>) and whether the input value is non-negative (<code>temp &gt;= 0</code>). If it is, the program copies the <code>temp</code> value to the array and increases the array index by one. At that point, because array numbering starts at zero, <code>i</code> equals the total number of entries to date. That is, if <code>i</code> starts out at <code>0</code>, the first cycle through the loop assigns a value to <code>naaq[0]</code> and then sets <code>i</code> to <code>1</code>.</p>
<p>The loop terminates when the array is filled or when the user enters a negative number. Note that the loop reads another value into <code>temp</code> only if <code>i</code> is less than <code>ArSize</code>&#8212;that is, only if there is still room left in the array.</p>
<p>After it gets data, the program uses an <code>if else</code> statement to comment if no data was entered (that is, if the first entry was a negative number) and to process the data if any is present.</p>
<h4 id="ch06lev2sec6">Setting Up Ranges with <code>&#38;&#38;</code></h4>
<p>The <code>&#38;&#38;</code> operator also lets you set up a series of <code>if else if else</code> statements, with each choice corresponding to a particular range of values. <a href="#ch06ex06">Listing 6.6</a> illustrates the approach. It also shows a useful technique for handling a series of messages. Just as a pointer-to-<code>char</code> variable can identify a single string by pointing to its beginning, an array of pointers-to-<code>char</code> can identify a series of strings. You simply assign the address of each string to a different array element. <a href="#ch06ex06">Listing 6.6</a> uses the <code>qualify</code> array to hold the addresses of four strings. For example, <code>qualify[1]</code> holds the address of the string <code>"mud tug-of-war\n"</code>. The program can then use <code>qualify[1</code>] as it would any other pointer to a string&#8212;for example, with <code>cout</code> or with <code>strlen()</code> or <code>strcmp()</code>. Using the <code>const</code> qualifier protects these strings from accidental alterations.</p>
<p class="caption1"><a id="page_266"/><a id="ch06ex06"/><strong>Listing 6.6. <code>more_and.cpp</code></strong></p><hr/>
<p class="programlisting1">// more_and.cpp -- using the logical AND operator<br/>#include &lt;iostream&gt;<br/>const char * qualify[4] =&#160;&#160;&#160;&#160;&#160;&#160;&#160;// an array of pointers<br/>{&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// to strings<br/>&#160;&#160;&#160;&#160;"10,000-meter race.\n",<br/>&#160;&#160;&#160;&#160;"mud tug-of-war.\n",<br/>&#160;&#160;&#160;&#160;"masters canoe jousting.\n",<br/>&#160;&#160;&#160;&#160;"pie-throwing festival.\n"<br/>};<br/>int main()<br/>{<br/>&#160;&#160;&#160;&#160;using namespace std;<br/>&#160;&#160;&#160;&#160;int age;<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "Enter your age in years: ";<br/>&#160;&#160;&#160;&#160;cin &gt;&gt; age;<br/>&#160;&#160;&#160;&#160;int index;<br/><br/>&#160;&#160;&#160;&#160;if (age &gt; 17 &#38;&#38; age &lt; 35)<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;index = 0;<br/>&#160;&#160;&#160;&#160;else if (age &gt;= 35 &#38;&#38; age &lt; 50)<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;index = 1;<br/>&#160;&#160;&#160;&#160;else if (age &gt;= 50 &#38;&#38; age &lt; 65)<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;index = 2;<br/>&#160;&#160;&#160;&#160;else<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;index = 3;<br/><br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "You qualify for the " &lt;&lt; qualify[index];<br/>&#160;&#160;&#160;&#160;return 0;<br/>}</p><hr/>
<p>Here is a sample run of the program in <a href="#ch06ex06">Listing 6.6</a>:</p>
<p class="programlisting">Enter your age in years: <span class="EmpStrong">87</span><br/>You qualify for the pie-throwing festival.</p>
<p>The entered age doesn&#8217;t match any of the test ranges, so the program sets <code>index</code> to <code>3</code> and then prints the corresponding string.</p>
<h5 id="ch06lev3sec2">Program Notes</h5>
<p>In <a href="#ch06ex06">Listing 6.6</a>, the expression <code>age &gt; 17 &#38;&#38; age &lt; 35</code> tests for ages between the two values&#8212;that is, ages in the range 18&#8211;34. The expression <code>age &gt;= 35 &#38;&#38; age &lt; 50</code> uses the <code>&gt;=</code> operator to include 35 in its range, which is 35&#8211;49. If the program used <code>age &gt; 35 &#38;&#38; age &lt; 50</code>, the value 35 would be missed by all the tests. When you use range tests, you should check that the ranges don&#8217;t have holes between them and that they don&#8217;t overlap. <a id="page_267"/>Also you need to be sure to set up each range correctly; see the sidebar &#8220;<a href="#ch06sb02">Range Tests</a>,&#8221; later in this section.</p>
<p>The <code>if else</code> statement serves to select an array index, which, in turn, identifies a particular string.</p>
<div class="sidebar"><hr/>
<p class="title"><a id="ch06sb02"/>Range Tests</p>
<p class="sidebarpara">Note that each part of a range test should use the AND operator to join two complete relational expressions:</p>
<p class="programlistingB">if (age &gt; 17 &#38;&#38; age &lt; 35)&#160;&#160;&#160;// OK</p>
<p class="sidebarpara">Don&#8217;t borrow from mathematics and use the following notation:</p>
<p class="programlistingB">if (17 &lt; age &lt; 35)&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// Don't do this!</p>
<p class="sidebarpara">If you make this mistake, the compiler won&#8217;t catch it as an error because it is still valid C++ syntax. The <code>&lt;</code> operator associates from left to right, so the previous expression means the following:</p>
<p class="programlistingB">if ( (17 &lt; age) &lt; 35)</p>
<p class="sidebarpara">But <code>17 &lt; age</code> is either <code>true</code>, or <code>1</code>, or else <code>false</code>, or <code>0</code>. In either case, the expression <code>17 &lt; age</code> is less than <code>35</code>, so the entire test is always <code>true</code>!</p>
<hr/></div>
<h4 id="ch06lev2sec7">The Logical NOT Operator: <code>!</code></h4>
<p>The <code>!</code> operator negates, or reverses the truth value of, the expression that follows it. That is, if <code>expression</code> is <code>true</code>, then <code>!expression</code> is <code>false</code>&#8212;and vice versa. More precisely, if <code>expression</code> is <code>true</code>, or nonzero, then <code>!expression</code> is <code>false</code>. Incidentally, many people call the exclamation point <em>bang</em>, making <code>!x</code> &#8220;bang-ex&#8221; and <code>!!x</code> &#8220;bang-bang-ex.&#8221;</p>
<p>Usually you can more clearly express a relationship without using the <code>!</code> operator:</p>
<p class="programlisting">if (!(x &gt; 5))&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// if (x &lt;= 5) is clearer</p>
<p>But the <code>!</code> operator can be useful with functions that return <code>true</code>/<code>false</code> values or values that can be interpreted that way. For example, <code>strcmp(s1,s2)</code> returns a nonzero (<code>true</code>) value if the two C-style strings <code>s1</code> and <code>s2</code> are different from each other and a zero value if they are the same. This implies that <code>!strcmp(s1,s2)</code> is <code>true</code> if the two strings are equal.</p>
<p><a href="#ch06ex07">Listing 6.7</a> uses the technique of applying the <code>!</code> operator to a function return value to screen numeric input for suitability to be assigned to type <code>int</code>. The user-defined function <code>is_int()</code>, which we&#8217;ll discuss further in a moment, returns <code>true</code> if its argument is within the range of values that can be assigned to type <code>int</code>. The program then uses the test <code>while(!is_int(num))</code> to reject values that don&#8217;t fit in the range.</p>
<p class="caption1"><a id="ch06ex07"/><strong>Listing 6.7. <code>not.cpp</code></strong></p><hr/>
<p class="programlisting1">// not.cpp -- using the not operator<br/>#include &lt;iostream&gt;<br/>#include &lt;climits&gt;<br/>bool is_int(double);<br/>int main()<br/>{<br/>&#160;&#160;&#160;&#160;using namespace std;<br/>&#160;&#160;&#160;&#160;double num;<br/><br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "Yo, dude! Enter an integer value: ";<br/>&#160;&#160;&#160;&#160;cin &gt;&gt; num;<br/>&#160;&#160;&#160;&#160;while (!is_int(num))&#160;&#160;&#160;&#160;// continue while num is not int-able<br/>&#160;&#160;&#160;&#160;{<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cout &lt;&lt; "Out of range -- please try again: ";<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cin &gt;&gt; num;<br/>&#160;&#160;&#160;&#160;}<br/>&#160;&#160;&#160;&#160;int val = int (num);&#160;&#160;&#160;&#160;// type cast<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "You've entered the integer " &lt;&lt; val &lt;&lt; "\nBye\n";<br/>&#160;&#160;&#160;&#160;return 0;<br/>}<br/><br/>bool is_int(double x)<br/>{<br/>&#160;&#160;&#160;&#160;if (x &lt;= INT_MAX &#38;&#38; x &gt;= INT_MIN)&#160;&#160;&#160;// use climits values<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return true;<br/>&#160;&#160;&#160;&#160;else<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return false;<br/>}</p><hr/>
<p><a id="page_268"/>Here is a sample run of the program in <a href="#ch06ex07">Listing 6.7</a> on a system with a 32-bit <code>int</code>:</p>
<p class="programlisting">Yo, dude! Enter an integer value: <span class="EmpStrong">6234128679</span><br/>Out of range -- please try again: <span class="EmpStrong">-8000222333</span><br/>Out of range -- please try again: <span class="EmpStrong">99999</span><br/>You've entered the integer 99999<br/>Bye</p>
<h5 id="ch06lev3sec3">Program Notes</h5>
<p>If you enter a too-large value to a program reading a type <code>int</code>, many C++ implementations simply truncate the value to fit, without informing you that data was lost. The program in <a href="#ch06ex07">Listing 6.7</a> avoids that by first reading the potential <code>int</code> as a <code>double</code>. The <code>double</code> type has more than enough precision to hold a typical <code>int</code> value, and its range is much greater. Another choice for holding the input value would be the <code>long long</code> type, assuming that it is wider than <code>int</code>.</p>
<p>The Boolean function <code>is_int()</code> uses the two symbolic constants (<code>INT_MAX</code> and <code>INT_MIN</code>), defined in the <code>climits</code> file (discussed in <a href="ch03.html#ch03">Chapter 3</a>, &#8220;<a href="ch03.html#ch03">Dealing with Data</a>&#8221;), to determine whether its argument is within the proper limits. If so, the program returns a value of <code>true</code>; otherwise, it returns <code>false</code>.</p>
<p><a id="page_269"/>The <code>main()</code> program uses a <code>while</code> loop to reject invalid input until the user gets it right. You could make the program friendlier by displaying the <code>int</code> limits when the input is out of range. After the input has been validated, the program assigns it to an <code>int</code> variable.</p>
<h4 id="ch06lev2sec8">Logical Operator Facts</h4>
<p>As mentioned earlier in this chapter, the C++ logical OR and logical AND operators have a lower precedence than relational operators. This means that an expression such as this</p>
<p class="programlisting">x &gt; 5 &#38;&#38; x &lt; 10</p>
<p>is interpreted this way:</p>
<p class="programlisting">(x &gt; 5) &#38;&#38; (x &lt; 10)</p>
<p>The <code>!</code> operator, on the other hand, has a higher precedence than any of the relational or arithmetic operators. Therefore, to negate an expression, you should enclose the expression in parentheses, like this:</p>
<p class="programlisting">!(x &gt; 5)&#160;&#160;&#160;&#160;&#160;// is it false that x is greater than 5<br/>!x &gt; 5&#160;&#160;&#160;&#160;&#160;&#160;&#160;// is !x greater than 5</p>
<p>Incidentally, the second expression here is always <code>false</code> because <code>!x</code> can have only the values <code>true</code> or <code>false</code>, which get converted to <code>1</code> or <code>0</code>.</p>
<p>The logical AND operator has a higher precedence than the logical OR operator. Thus this expression:</p>
<p class="programlisting">age &gt; 30 &#38;&#38; age &lt; 45 || weight &gt; 300</p>
<p>means the following:</p>
<p class="programlisting">(age &gt; 30 &#38;&#38; age &lt; 45) || weight &gt; 300</p>
<p>That is, one condition is that <code>age</code> be in the range 31&#8211;44, and the second condition is that <code>weight</code> be greater than 300. The entire expression is <code>true</code> if one or the other or both of these conditions are <code>true</code>.</p>
<p>You can, of course, use parentheses to tell the program the interpretation you want. For example, suppose you want to use <code>&#38;&#38;</code> to combine the condition that <code>age</code> be greater than 50 or <code>weight</code> be greater than 300 with the condition that <code>donation</code> be greater than 1,000. You have to enclose the OR part within parentheses:</p>
<p class="programlisting">(age &gt; 50 || weight &gt; 300) &#38;&#38; donation &gt; 1000</p>
<p>Otherwise, the compiler combines the <code>weight</code> condition with the <code>donation</code> condition instead of with the <code>age</code> condition.</p>
<p>Although the C++ operator precedence rules often make it possible to write compound comparisons without using parentheses, the simplest course of action is to use parentheses to group the tests, whether or not the parentheses are needed. It makes the code easier to read, it doesn&#8217;t force someone else to look up some of the less commonly <a id="page_270"/>used precedence rules, and it reduces the chance of making errors because you don&#8217;t quite remember the exact rule that applies.</p>
<p>C++ guarantees that when a program evaluates a logical expression, it evaluates it from left to right and stops evaluation as soon as it knows what the answer is. Suppose, for example, that you have this condition:</p>
<p class="programlisting">x != 0&#160;&#160;&#38;&#38; 1.0 / x &gt; 100.0</p>
<p>If the first condition is <code>false</code>, then the whole expression must be <code>false</code>. That&#8217;s because for this expression to be <code>true</code>, each individual condition must be <code>true</code>. Knowing the first condition is <code>false</code>, the program doesn&#8217;t bother evaluating the second condition. That&#8217;s fortunate in this example because evaluating the second condition would result in dividing by zero, which is not in a computer&#8217;s repertoire of possible actions.</p>
<h4 id="ch06lev2sec9">Alternative Representations</h4>
<p>Not all keyboards provide all the symbols used for the logical operators, so the C++ Standard provides alternative representations, as shown in <a href="#ch06table03">Table 6.3</a>. The identifiers <code>and</code>, <code>or</code>, and <code>not</code> are C++ reserved words, meaning that you can&#8217;t use them as names for variables and so on. They are not considered keywords because they are alternative representations of existing language features. Incidentally, these are not reserved words in C, but a C program can use them as operators, provided that the program includes the <code>iso646.h</code> header file. C++ does not require using a header file.</p>
<p class="caption"><a id="ch06table03"/><strong>Table 6.3. Logical Operators: Alternative Representations</strong></p>
<p class="image"><img src="graphics/06tab03.jpg" alt="Image"/></p>
<h3 id="ch06lev1sec3">The <code>cctype</code> Library of Character Functions</h3>
<p>C++ has inherited from C a handy package of character-related functions, prototyped in the <code>cctype</code> header file (<code>ctype.h</code>, in the older style), that simplify such tasks as determining whether a character is an uppercase letter or a digit or punctuation. For example, the <code>isalpha(ch)</code> function returns a nonzero value if <code>ch</code> is a letter and a zero value otherwise. Similarly, the <code>ispunct(ch)</code> function returns a <code>true</code> value only if <code>ch</code> is a punctuation character, such as a comma or period. (These functions have return type <code>int</code> rather than <code>bool</code>, but the usual <code>bool</code> conversions allow you to treat them as type <code>bool</code>.)</p>
<p>Using these functions is more convenient than using the AND and OR operators. For example, here&#8217;s how you might use AND and OR to test whether a character <code>ch</code> is an alphabetic character:</p>
<p class="programlisting">if ((ch &gt;= 'a' &#38;&#38; ch &lt;= 'z') || (ch &gt;= 'A' &#38;&#38; ch &lt;= 'Z'))</p>
<p><a id="page_271"/>Compare that to using <code>isalpha()</code>:</p>
<p class="programlisting">if (isalpha(ch))</p>
<p>Not only is <code>isalpha()</code> easier to use, it is more general. The AND/OR form assumes that character codes for A through Z are in sequence, with no other characters having codes in that range. This assumption is true for ASCII codes, but it isn&#8217;t always true in general.</p>
<p><a href="#ch06ex08">Listing 6.8</a> demonstrates some functions from the <code>cctype</code> family. In particular, it uses <code>isalpha()</code>, which tests for alphabetic characters; <code>isdigits()</code>, which tests for digit characters, such as 3; <code>isspace()</code>, which tests for whitespace characters, such as newlines, spaces, and tabs; and <code>ispunct()</code>, which tests for punctuation characters. The program also reviews the <code>if else if</code> structure and using a <code>while</code> loop with <code>cin.get(char)</code>.</p>
<p class="caption1"><a id="ch06ex08"/><strong>Listing 6.8. <code>cctypes.cpp</code></strong></p><hr/>
<p class="programlisting1">// cctypes.cpp -- using the ctype.h library<br/>#include &lt;iostream&gt;<br/>#include &lt;cctype&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// prototypes for character functions<br/>int main()<br/>{<br/>&#160;&#160;&#160;&#160;using namespace std;<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "Enter text for analysis, and type @"<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;" to terminate input.\n";<br/>&#160;&#160;&#160;&#160;char ch;<br/>&#160;&#160;&#160;&#160;int whitespace = 0;<br/>&#160;&#160;&#160;&#160;int digits = 0;<br/>&#160;&#160;&#160;&#160;int chars = 0;<br/>&#160;&#160;&#160;&#160;int punct = 0;<br/>&#160;&#160;&#160;&#160;int others = 0;<br/><br/>&#160;&#160;&#160;&#160;cin.get(ch);&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// get first character<br/>&#160;&#160;&#160;&#160;while (ch != '@')&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// test for sentinel<br/>&#160;&#160;&#160;&#160;{<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if(isalpha(ch))&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// is it an alphabetic character?<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;chars++;<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else if(isspace(ch))&#160;&#160;&#160;&#160;// is it a whitespace character?<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;whitespace++;<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else if(isdigit(ch))&#160;&#160;&#160;&#160;// is it a digit?<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;digits++;<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else if(ispunct(ch))&#160;&#160;&#160;&#160;// is it punctuation?<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;punct++;<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;others++;<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cin.get(ch);&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// get next character<br/>&#160;&#160;&#160;&#160;}<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; chars &lt;&lt; " letters, "<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;&lt; whitespace &lt;&lt; " whitespace, "<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;&lt; digits &lt;&lt; " digits, "<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;&lt; punct &lt;&lt; " punctuations, "<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;&lt; others &lt;&lt; " others.\n";<br/>&#160;&#160;&#160;&#160;return 0;<br/>}</p><hr/>
<p><a id="page_272"/>Here is a sample run of the program in <a href="#ch06ex08">Listing 6.8</a> (note that the whitespace count includes newlines):</p>
<p class="programlisting">Enter text for analysis, and type @ to terminate input.<br/><span class="EmpStrong">AdrenalVision International producer Adrienne Vismonger</span><br/><span class="EmpStrong">announced production of their new 3-D film, a remake of</span><br/><span class="EmpStrong">"My Dinner with Andre," scheduled for 2013. "Wait until</span><br/><span class="EmpStrong">you see the the new scene with an enraged Collossipede!"@</span><br/>177 letters, 33 whitespace, 5 digits, 9 punctuations, 0 others.</p>
<p><a href="#ch06table04">Table 6.4</a> summarizes the functions available in the <code>cctype</code> package. Some systems may lack some of these functions or have additional ones.</p>
<p class="caption"><a id="ch06table04"/><strong>Table 6.4. The <code>cctype</code> Character Functions</strong></p>
<p class="image"><img src="graphics/06tab04.jpg" alt="Image"/></p>
<h3 id="ch06lev1sec4">The <code>?:</code> Operator</h3>
<p><a id="page_273"/>C++ has an operator that can often be used instead of the <code>if else</code> statement. This operator is called the <em>conditional operator</em>, written <code>?:</code>, and, for you trivia buffs, it is the only C++ operator that requires three operands. The general form looks like this:</p>
<p class="programlisting"><span class="EmpItalic">expression1</span> ? <span class="EmpItalic">expression2</span> : <span class="EmpItalic">expression3</span></p>
<p>If <em><code>expression1</code></em> is <code>true</code>, then the value of the whole conditional expression is the value of <em><code>expression2</code></em>. Otherwise, the value of the whole expression is the value of <em><code>expression3</code></em>. Here are two examples that show how the operator works:</p>
<p class="programlisting">5 &gt; 3 ? 10 : 12&#160;&#160;// 5 &gt; 3 is true, so expression value is 10<br/>3 == 9? 25 : 18&#160;&#160;// 3 == 9 is false, so expression value is 18</p>
<p>We can paraphrase the first example this way: If 5 is greater than 3, the expression evaluates to 10; otherwise, it evaluates to 12. In real programming situations, of course, the expressions would involve variables.</p>
<p><a href="#ch06ex09">Listing 6.9</a> uses the conditional operator to determine the larger of two values.</p>
<p class="caption1"><a id="ch06ex09"/><strong>Listing 6.9. <code>condit.cpp</code></strong></p><hr/>
<p class="programlisting1">// condit.cpp -- using the conditional operator<br/>#include &lt;iostream&gt;<br/>int main()<br/>{<br/>&#160;&#160;&#160;&#160;using namespace std;<br/>&#160;&#160;&#160;&#160;int a, b;<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "Enter two integers: ";<br/>&#160;&#160;&#160;&#160;cin &gt;&gt; a &gt;&gt; b;<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "The larger of " &lt;&lt; a &lt;&lt; " and " &lt;&lt; b;<br/>&#160;&#160;&#160;&#160;int c = a &gt; b ? a : b;&#160;&#160;&#160;// c = a if a &gt; b, else c = b<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; " is " &lt;&lt; c &lt;&lt; endl;<br/>&#160;&#160;&#160;&#160;return 0;<br/>}</p><hr/>
<p><a id="page_274"/>Here is a sample run of the program in <a href="#ch06ex09">Listing 6.9</a>:</p>
<p class="programlisting">Enter two integers: <span class="EmpStrong">25 28</span><br/>The larger of 25 and 28 is 28</p>
<p>The key part of the program is this statement:</p>
<p class="programlisting">int c = a &gt; b ? a : b;</p>
<p>It produces the same result as the following statements:</p>
<p class="programlisting">int c;<br/>if (a &gt; b)<br/>&#160;&#160;&#160;&#160;c = a;<br/>else<br/>&#160;&#160;&#160;&#160;c = b;</p>
<p>Compared to the <code>if else</code> sequence, the conditional operator is more concise but, at first glance, less obvious. One difference between the two approaches is that the conditional operator produces an expression and hence a single value that can be assigned or be incorporated into a larger expression, as the program in <a href="#ch06ex09">Listing 6.9</a> does when it assigns the value of the conditional expression to the variable <code>c</code>. The conditional operator&#8217;s concise form, unusual syntax, and overall weird appearance make it a great favorite among programmers who appreciate those qualities. One favorite trick for the reprehensible goal of concealing the purpose of code is to nest conditional expressions within one another, as the following mild example shows:</p>
<p class="programlisting">const char x[2] [20] = {"Jason ","at your service\n"};<br/>const char * y = "Quillstone ";<br/><br/>for (int i = 0; i &lt; 3; i++)<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; ((i &lt; 2)? !i ? x [i] : y : x[1]);</p>
<p>This is merely an obscure (but, by no means maximally obscure) way to print the three strings in the following order:</p>
<p class="programlisting">Jason Quillstone at your service</p>
<p>In terms of readability, the conditional operator is best suited for simple relationships and simple expression values:</p>
<p class="programlisting">x = (x &gt; y) ? x : y;</p>
<p>If the code becomes more involved, it can probably be expressed more clearly as an <code>if else</code> statement.</p>
<h3 id="ch06lev1sec5">The <code>switch</code> Statement</h3>
<p>Suppose you create a screen menu that asks the user to select one of five choices&#8212;for example, Cheap, Moderate, Expensive, Extravagant, and Excessive. You can extend an <code>if else if else</code> sequence to handle five alternatives, but the C++ <code>switch</code> statement more <a id="page_275"/>easily handles selecting a choice from an extended list. Here&#8217;s the general form for a <code>switch</code> statement:</p>
<p class="programlisting">switch (<span class="EmpItalic">integer-expression</span>)<br/>{<br/>&#160;&#160;&#160;&#160;&#160;&#160;case <span class="EmpItalic">label1</span> : <span class="EmpItalic">statement(s)</span><br/>&#160;&#160;&#160;&#160;&#160;&#160;case <span class="EmpItalic">label2</span> : <span class="EmpItalic">statement(s)</span><br/>&#160;&#160;&#160;&#160;&#160;...<br/>&#160;&#160;&#160;&#160;&#160;&#160;default&#160;&#160;&#160;&#160;&#160;: <span class="EmpItalic">statement(s)</span><br/>}</p>
<p>A C++ <code>switch</code> statement acts as a routing device that tells the computer which line of code to execute next. On reaching a <code>switch</code> statement, a program jumps to the line labeled with the value corresponding to the value of <em><code>integer-expression</code></em>. For example, if <em><code>integer-expression</code></em> has the value <code>4</code>, the program goes to the line that has a <code>case 4:</code> label. The value <em><code>integer-expression</code></em>, as the name suggests, must be an expression that reduces to an integer value. Also each label must be an integer constant expression. Most often, labels are simple <code>int</code> or <code>char</code> constants, such as <code>1</code> or <code>'q'</code>, or enumerators. If <em><code>integer-expression</code></em> doesn&#8217;t match any of the labels, the program jumps to the line labeled <code>default</code>. The <code>default</code> label is optional. If you omit it and there is no match, the program jumps to the next statement following the <code>switch</code> (see <a href="#ch06fig03">Figure 6.3</a>).</p>
<p class="caption"><a id="ch06fig03"/><strong>Figure 6.3. The structure of <code>switch</code> statements.</strong></p>
<p class="image"><img src="graphics/06fig03.jpg" alt="Image"/></p>
<p>The <code>switch</code> statement is different from similar statements in languages such as Pascal in a very important way. Each C++ case label functions only as a line label, not as a boundary between choices. That is, after a program jumps to a particular line in a <code>switch</code>, it then sequentially executes all the statements following that line in the switch unless you explicitly direct it otherwise. Execution does <em>not</em> automatically stop at the next case. To make execution stop at the end of a particular group of statements, you must use the <code>break</code> statement. This causes execution to jump to the statement following the <code>switch</code>.</p>
<p><a href="#ch06ex10">Listing 6.10</a> shows how to use <code>switch</code> and <code>break</code> together to implement a simple menu for executives. The program uses a <code>showmenu()</code> function to display a set of choices. A <code>switch</code> statement then selects an action based on the user&#8217;s response.</p>
<div class="note"><hr/>
<p class="title"><a id="ch06note01"/><a id="page_276"/>Note</p>
<p class="notepara">Some hardware/operating system combinations treat the <code>\a</code> escape sequence (used in <code>case 1</code> in <a href="#ch06ex10">Listing 6.10</a>) as silent.</p>
<hr/></div>
<p class="caption1"><a id="ch06ex10"/><strong>Listing 6.10. <code>switch.cpp</code></strong></p><hr/>
<p class="programlisting1">// switch.cpp -- using the switch statement<br/>#include &lt;iostream&gt;<br/>using namespace std;<br/>void showmenu();&#160;&#160;&#160;// function prototypes<br/>void report();<br/>void comfort();<br/>int main()<br/>{<br/>&#160;&#160;&#160;&#160;showmenu();<br/>&#160;&#160;&#160;&#160;int choice;<br/>&#160;&#160;&#160;&#160;cin &gt;&gt; choice;<br/>&#160;&#160;&#160;&#160;while (choice != 5)<br/>&#160;&#160;&#160;&#160;{<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;switch(choice)<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;{<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;case 1&#160;&#160;:&#160;&#160;&#160;cout &lt;&lt; "\a\n";<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;break;<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;case 2&#160;&#160;:&#160;&#160;&#160;report();<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;break;<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;case 3&#160;&#160;:&#160;&#160;&#160;cout &lt;&lt; "The boss was in all day.\n";<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;break;<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;case 4&#160;&#160;:&#160;&#160;&#160;comfort();<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;break;<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;default :&#160;&#160;&#160;cout &lt;&lt; "That's not a choice.\n";<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;}<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;showmenu();<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cin &gt;&gt; choice;<br/>&#160;&#160;&#160;&#160;}<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "Bye!\n";<br/>&#160;&#160;&#160;&#160;return 0;<br/>}<br/><br/>void showmenu()<br/>{<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "Please enter 1, 2, 3, 4, or 5:\n"<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;"1) alarm&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;2) report\n"<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;"3) alibi&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;4) comfort\n"<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;"5) quit\n";<br/>}<br/>void report()<br/>{<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "It's been an excellent week for business.\n"<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;"Sales are up 120%. Expenses are down 35%.\n";<br/>}<br/>void comfort()<br/>{<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "Your employees think you are the finest CEO\n"<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;"in the industry. The board of directors think\n"<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;"you are the finest CEO in the industry.\n";<br/>}</p><hr/>
<p><a id="page_277"/>Here is a sample run of the executive menu program in <a href="#ch06ex10">Listing 6.10</a>:</p>
<p class="programlisting">Please enter 1, 2, 3, 4, or 5:<br/>1) alarm&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;2) report<br/>3) alibi&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;4) comfort<br/>5) quit<br/><span class="EmpStrong">4</span><br/>Your employees think you are the finest CEO<br/>in the industry. The board of directors think<br/>you are the finest CEO in the industry.<br/>Please enter 1, 2, 3, 4, or 5:<br/>1) alarm&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;2) report<br/>3) alibi&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;4) comfort<br/>5) quit<br/><span class="EmpStrong">2</span><br/>It's been an excellent week for business.<br/>Sales are up 120%. Expenses are down 35%.<br/>Please enter 1, 2, 3, 4, or 5:<br/>1) alarm&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;2) report<br/>3) alibi&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;4) comfort<br/>5) quit<br/><span class="EmpStrong">6</span><br/>That's not a choice.<br/>Please enter 1, 2, 3, 4, or 5:<br/>1) alarm&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;2) report<br/>3) alibi&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;4) comfort<br/>5) quit<br/><span class="EmpStrong">5</span><br/>Bye!</p>
<p>The <code>while</code> loop terminates when the user enters <strong><code>5</code></strong>. Entering <strong><code>1</code></strong> through <strong><code>4</code></strong> activates the corresponding choice from the <code>switch</code> list, and entering <strong><code>6</code></strong> triggers the default statements.</p>
<p>Note that input has to be an integer for this program to work correctly. If, for example, you enter a letter, the input statement will fail, and the loop will cycle endlessly until you kill the program. To deal with those who don&#8217;t follow instructions, it&#8217;s better to use character input.</p>
<p><a id="page_278"/>As noted earlier, this program needs the <code>break</code> statements to confine execution to a particular portion of a <code>switch</code> statement. To see that this is so, you can remove the <code>break</code> statements from <a href="#ch06ex10">Listing 6.10</a> and see how it works afterward. You&#8217;ll find, for example, that entering <strong><code>2</code></strong> causes the program to execute <em>all</em> the statements associated with case labels 2, 3, 4, and the default. C++ works this way because that sort of behavior can be useful. For one thing, it makes it simple to use multiple labels. For example, suppose you rewrote <a href="#ch06ex10">Listing 6.10</a> using characters instead of integers as menu choices and switch labels. In that case, you could use both an uppercase and a lowercase label for the same statements:</p>
<p class="programlisting">char choice;<br/>cin &gt;&gt; choice;<br/>while (choice != 'Q' &#38;&#38; choice != 'q')<br/>{<br/>&#160;&#160;&#160;&#160;switch(choice)<br/>&#160;&#160;&#160;&#160;{<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;case 'a':<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;case 'A': cout &lt;&lt; "\a\n";<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;break;<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;case 'r':<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;case 'R': report();<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;break;<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;case 'l':<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;case 'L': cout &lt;&lt; "The boss was in all day.\n";<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;break;<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;case 'c':<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;case 'C': comfort();<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;break;<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;default : cout &lt;&lt; "That's not a choice.\n";<br/>&#160;&#160;&#160;&#160;}<br/>&#160;&#160;&#160;&#160;showmenu();<br/>&#160;&#160;&#160;&#160;cin &gt;&gt; choice;<br/>}</p>
<p>Because there is no <code>break</code> immediately following <code>case 'a'</code>, program execution passes on to the next line, which is the statement following <code>case 'A'</code>.</p>
<h4 id="ch06lev2sec10">Using Enumerators as Labels</h4>
<p><a href="#ch06ex11">Listing 6.11</a> illustrates using <code>enum</code> to define a set of related constants and then using the constants in a <code>switch</code> statement. In general, <code>cin</code> doesn&#8217;t recognize enumerated types (it can&#8217;t know how you will define them), so the program reads the choice as an <code>int</code>. When the <code>switch</code> statement compares the <code>int</code> value to an enumerator case label, it promotes the enumerator to <code>int</code>. Also the enumerators are promoted to type <code>int</code> in the <code>while</code> loop test condition.</p>
<p class="caption1"><a id="page_279"/><a id="ch06ex11"/><strong>Listing 6.11. <code>enum.cpp</code></strong></p><hr/>
<p class="programlisting1">// enum.cpp -- using enum<br/>#include &lt;iostream&gt;<br/>// create named constants for 0 - 6<br/>enum {red, orange, yellow, green, blue, violet, indigo};<br/><br/>int main()<br/>{<br/>&#160;&#160;&#160;&#160;using namespace std;<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "Enter color code (0-6): ";<br/>&#160;&#160;&#160;&#160;int code;<br/>&#160;&#160;&#160;&#160;cin &gt;&gt; code;<br/>&#160;&#160;&#160;&#160;while (code &gt;= red &#38;&#38; code &lt;= indigo)<br/>&#160;&#160;&#160;&#160;{<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;switch (code)<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;{<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;case red&#160;&#160;&#160;&#160;&#160;: cout &lt;&lt; "Her lips were red.\n"; break;<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;case orange&#160;&#160;: cout &lt;&lt; "Her hair was orange.\n"; break;<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;case yellow&#160;&#160;: cout &lt;&lt; "Her shoes were yellow.\n"; break;<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;case green&#160;&#160;&#160;: cout &lt;&lt; "Her nails were green.\n"; break;<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;case blue&#160;&#160;&#160;&#160;: cout &lt;&lt; "Her sweatsuit was blue.\n"; break;<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;case violet&#160;&#160;: cout &lt;&lt; "Her eyes were violet.\n"; break;<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;case indigo&#160;&#160;: cout &lt;&lt; "Her mood was indigo.\n"; break;<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;}<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cout &lt;&lt; "Enter color code (0-6): ";<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cin &gt;&gt; code;<br/>&#160;&#160;&#160;&#160;}<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "Bye\n";<br/>&#160;&#160;&#160;&#160;return 0;<br/>}</p><hr/>
<p>Here&#8217;s sample output from the program in <a href="#ch06ex11">Listing 6.11</a>:</p>
<p class="programlisting">Enter color code (0-6): <span class="EmpStrong">3</span><br/>Her nails were green.<br/>Enter color code (0-6): <span class="EmpStrong">5</span><br/>Her eyes were violet.<br/>Enter color code (0-6): <span class="EmpStrong">2</span><br/>Her shoes were yellow.<br/>Enter color code (0-6): <span class="EmpStrong">8</span><br/>Bye</p>
<h4 id="ch06lev2sec11"><code>switch</code> and <code>if else</code></h4>
<p>Both the <code>switch</code> statement and the <code>if else</code> statement let a program select from a list of alternatives. The <code>if else</code> is the more versatile of the two. For example, it can handle ranges, as in the following:</p>
<p class="programlisting"><a id="page_280"/>if (age &gt; 17 &#38;&#38; age &lt; 35)<br/>&#160;&#160;&#160;&#160;index = 0;<br/>else if (age &gt;= 35 &#38;&#38; age &lt; 50)<br/>&#160;&#160;&#160;&#160;index = 1;<br/>else if (age &gt;= 50 &#38;&#38; age &lt; 65)<br/>&#160;&#160;&#160;&#160;index = 2;<br/>else<br/>&#160;&#160;&#160;&#160;index = 3;</p>
<p>The <code>switch</code> statement, on the other hand, isn&#8217;t designed to handle ranges. Each <code>switch</code> case label must be a single value. Also that value must be an integer (which includes <code>char</code>), so a <code>switch</code> statement can&#8217;t handle floating-point tests. And the case label value must be a constant. If your alternatives involve ranges or floating-point tests or comparing two variables, you should use <code>if else</code>.</p>
<p>If, however, all the alternatives can be identified with integer constants, you can use a <code>switch</code> or an <code>if else</code> statement. Because that&#8217;s precisely the situation that the <code>switch</code> statement is designed to process, the <code>switch</code> statement is usually the more efficient choice in terms of code size and execution speed, unless there are only a couple alternatives from which to choose.</p>
<div class="note"><hr/>
<p class="title"><a id="ch06note02"/>Tip</p>
<p class="notepara">If you can use either an <code>if else if</code> sequence or a <code>switch</code> statement, the usual practice is to use <code>switch</code> if you have three or more alternatives.</p>
<hr/></div>
<h3 id="ch06lev1sec6">The <code>break</code> and <code>continue</code> Statements</h3>
<p>The <code>break</code> and <code>continue</code> statements enable a program to skip over parts of the code. You can use the <code>break</code> statement in a <code>switch</code> statement and in any of the loops. It causes program execution to pass to the next statement following the <code>switch</code> or the loop. The <code>continue</code> statement is used in loops and causes a program to skip the rest of the body of the loop and then start a new loop cycle (see <a href="#ch06fig04">Figure 6.4</a>).</p>
<p class="caption"><a id="ch06fig04"/><strong>Figure 6.4. The structure of <code>continue</code> and <code>break</code> statements.</strong></p>
<p class="image"><img src="graphics/06fig04.jpg" alt="Image"/></p>
<p><a href="#ch06ex12">Listing 6.12</a> shows how the two statements work. The program lets you enter a line of text. The loop echoes each character and uses <code>break</code> to terminate the loop if the character is a period. This shows how you can use <code>break</code> to terminate a loop from within when some condition becomes <code>true</code>. Next the program counts spaces but not other characters. The loop uses <code>continue</code> to skip over the counting part of the loop when the character isn&#8217;t a space.</p>
<p class="caption1"><a id="ch06ex12"/><strong>Listing 6.12. <code>jump.cpp</code></strong></p><hr/>
<p class="programlisting1">// jump.cpp -- using continue and break<br/>#include &lt;iostream&gt;<br/>const int ArSize = 80;<br/>int main()<br/>{<br/>&#160;&#160;&#160;&#160;using namespace std;<br/><a id="page_281"/>&#160;&#160;&#160;&#160;char line[ArSize];<br/>&#160;&#160;&#160;&#160;int spaces = 0;<br/><br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "Enter a line of text:\n";<br/>&#160;&#160;&#160;&#160;cin.get(line, ArSize);<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "Complete line:\n" &lt;&lt; line &lt;&lt; endl;<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "Line through first period:\n";<br/>&#160;&#160;&#160;&#160;for (int i = 0; line[i] != '\0'; i++)<br/>&#160;&#160;&#160;&#160;{<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cout &lt;&lt; line[i];&#160;&#160;&#160;&#160;// display character<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if (line[i] == '.') // quit if it's a period<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;break;<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if (line[i] != ' ') // skip rest of loop<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;continue;<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;spaces++;<br/>&#160;&#160;&#160;&#160;}<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "\n" &lt;&lt; spaces &lt;&lt; " spaces\n";<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "Done.\n";<br/>&#160;&#160;&#160;&#160;return 0;<br/>}</p><hr/>
<p><a id="page_282"/>Here&#8217;s a sample run of the program in <a href="#ch06ex12">Listing 6.12</a>:</p>
<p class="programlisting">Enter a line of text:<br/><span class="EmpStrong">Let's do lunch today. You can pay!</span><br/>Complete line:<br/>Let's do lunch today. You can pay!<br/>Line through first period:<br/>Let's do lunch today.<br/>3 spaces<br/>Done.</p>
<h4 id="ch06lev2sec12">Program Notes</h4>
<p>Note that whereas the <code>continue</code> statement causes the program in <a href="#ch06ex12">Listing 6.12</a> to skip the rest of the loop body, it doesn&#8217;t skip the loop update expression. In a <code>for</code> loop, the <code>continue</code> statement makes the program skip directly to the update expression and then to the test expression. For a <code>while</code> loop, however, <code>continue</code> makes the program go directly to the test expression. So any update expression in a <code>while</code> loop body following the <code>continue</code> would be skipped. In some cases, that could be a problem.</p>
<p>This program doesn&#8217;t have to use <code>continue</code>. Instead, it could use this code:</p>
<p class="programlisting">if (line[i] == ' ')<br/>&#160;&#160;&#160;&#160;spaces++;</p>
<p>However, the <code>continue</code> statement can make a program more readable when several statements follow the <code>continue</code>. That way, you don&#8217;t need to make all those statements part of an <code>if</code> statement.</p>
<p>C++, like C, also has a <code>goto</code> statement. A statement like this means to jump to the location bearing the <code>paris:</code> label:</p>
<p class="programlisting">goto paris;</p>
<p>That is, you can have code like this:</p>
<p class="programlisting">char ch;<br/>cin &gt;&gt; ch;<br/>if (ch == 'P')<br/>&#160;&#160;&#160;&#160;&#160;&#160;goto paris;<br/>cout &lt;&lt; ...<br/>...<br/>paris: cout &lt;&lt; "You've just arrived at Paris.\n";</p>
<p>In most circumstances (some would say in all circumstances), using <code>goto</code> is a bad hack, and you should use structured controls, such as <code>if else</code>, <code>switch</code>, <code>continue</code>, and the like, to control program flow.</p>
<h3 id="ch06lev1sec7">Number-Reading Loops</h3>
<p><a id="page_283"/>Say you&#8217;re preparing a program to read a series of numbers into an array. You want to give the user the option to terminate input before filling the array. One way to do this is utilize how <code>cin</code> behaves. Consider the following code:</p>
<p class="programlisting">int n;<br/>cin &gt;&gt; n;</p>
<p>What happens if the user responds by entering a word instead of a number? Four things occur in such a mismatch:</p>
<p class="indenthandingB">&#8226; The value of <code>n</code> is left unchanged.</p>
<p class="indenthandingB">&#8226; The mismatched input is left in the input queue.</p>
<p class="indenthandingB">&#8226; An error flag is set in the <code>cin</code> object.</p>
<p class="indenthandingB">&#8226; The call to the <code>cin</code> method, if converted to type <code>bool</code>, returns <code>false</code>.</p>
<p>The fact that the method returns <code>false</code> means that you can use non-numeric input to terminate a number-reading loop. The fact that non-numeric input sets an error flag means that you have to reset the flag before the program can read more input. The <code>clear()</code> method, which also resets the end-of-file (EOF) condition (see <a href="ch05.html#ch05">Chapter 5</a>), resets the bad input flag. (Either bad input or the EOF can cause <code>cin</code> to return <code>false</code>. <a href="ch17.html#ch17">Chapter 17</a>, &#8220;<a href="ch17.html#ch17">Input, Output, and Files</a>,&#8221; discusses how to distinguish between the two cases.) Let&#8217;s look at a couple examples that illustrate these techniques.</p>
<p>Say you want to write a program that calculates the average weight of your day&#8217;s catch of fish. There&#8217;s a five-fish limit, so a five-element array can hold all the data, but it&#8217;s possible that you could catch fewer fish. <a href="#ch06ex13">Listing 6.13</a> uses a loop that terminates if the array is full or if you enter non-numeric input.</p>
<p class="caption1"><a id="ch06ex13"/><strong>Listing 6.13. <code>cinfish.cpp</code></strong></p><hr/>
<p class="programlisting1">// cinfish.cpp -- non-numeric input terminates loop<br/>#include &lt;iostream&gt;<br/>const int Max = 5;<br/>int main()<br/>{<br/>&#160;&#160;&#160;&#160;using namespace std;<br/>// get data<br/>&#160;&#160;&#160;&#160;double fish[Max];<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "Please enter the weights of your fish.\n";<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "You may enter up to " &lt;&lt; Max<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;&lt; " fish &lt;q to terminate&gt;.\n";<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "fish #1: ";<br/>&#160;&#160;&#160;&#160;int i = 0;<br/>&#160;&#160;&#160;&#160;while (i &lt; Max &#38;&#38; cin &gt;&gt; fish[i]) {<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if (++i &lt; Max)<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cout &lt;&lt; "fish #" &lt;&lt; i+1 &lt;&lt; ": ";<br/>&#160;&#160;&#160;&#160;}<br/>// calculate average<br/>&#160;&#160;&#160;&#160;double total = 0.0;<br/>&#160;&#160;&#160;&#160;for (int j = 0; j &lt; i; j++)<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;total += fish[j];<br/>// report results<br/>&#160;&#160;&#160;&#160;if (i == 0)<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cout &lt;&lt; "No fish\n";<br/>&#160;&#160;&#160;&#160;else<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cout &lt;&lt; total / i &lt;&lt; " = average weight of "<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;&lt; i &lt;&lt; " fish\n";<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "Done.\n";<br/>&#160;&#160;&#160;&#160;return 0;<br/>}</p><hr/>
<div class="note"><hr/>
<p class="title"><a id="ch06note03"/><a id="page_284"/>Note</p>
<p class="notepara">As mentioned earlier, some execution environments require additional code to keep the window open so that you can see the output. In this example, because the input <code>'q'</code> turns off further input, the treatment is more elaborate:</p>
<p class="programlistingB"><br/>if (!cin)&#160;&#160;// input terminated by non-numeric response<br/>{<br/>&#160;&#160;&#160;&#160;cin.clear();&#160;&#160;// reset input<br/>&#160;&#160;&#160;&#160;cin.get();&#160;&#160;&#160;&#160;// read q<br/>}<br/>cin.get();&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// read end of line after last input<br/>cin.get();&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// wait for user to press &lt;Enter&gt;</p>
<p class="notepara">You also could use code similar to this in <a href="#ch06ex13">Listing 6.13</a> if you wanted the program to accept more input after exiting the loop.</p>
<p class="notepara"><a href="#ch06ex14">Listing 6.14</a> further illustrates using the <code>cin</code> return value and resetting <code>cin</code>.</p>
<hr/></div>
<p>The expression <code>cin &gt;&gt; fish[i]</code> in <a href="#ch06ex13">Listing 6.13</a> is really a <code>cin</code> method function call, and the function returns <code>cin</code>. If <code>cin</code> is part of a test condition, it&#8217;s converted to type <code>bool</code>. The conversion value is <code>true</code> if input succeeds and <code>false</code> otherwise. A <code>false</code> value for the expression terminates the loop. By the way, here&#8217;s a sample run of the program:</p>
<p class="programlisting">Please enter the weights of your fish.<br/>You may enter up to 5 fish &lt;q to terminate&gt;.<br/>fish #1: <span class="EmpStrong">30</span><br/>fish #2: <span class="EmpStrong">35</span><br/>fish #3: <span class="EmpStrong">25</span><br/>fish #4: <span class="EmpStrong">40</span><br/>fish #5: <span class="EmpStrong">q</span><br/>32.5 = average weight of 4 fish<br/>Done.</p>
<p><a id="page_285"/>Note the following line of code:</p>
<p class="programlisting">while (i &lt; Max &#38;&#38; cin &gt;&gt; fish[i]) {</p>
<p>Recall that C++ doesn&#8217;t evaluate the right side of a logical AND expression if the left side is <code>false</code>. In such a case, evaluating the right side means using <code>cin</code> to place input into the array. If <code>i</code> does equal <code>Max</code>, the loop terminates without trying to read a value into a location past the end of the array.</p>
<p>The preceding example doesn&#8217;t attempt to read any input after non-numeric input. Let&#8217;s look at a case that does. Suppose you are required to submit exactly five golf scores to a C++ program to establish your average. If a user enters non-numeric input, the program should object, insisting on numeric input. As you&#8217;ve seen, you can use the value of a <code>cin</code> input expression to test for non-numeric input. Suppose the program finds that the user enters the wrong stuff. It needs to take three steps:</p>
<p class="indenthandingN"><strong>1.</strong> Reset <code>cin</code> to accept new input.</p>
<p class="indenthandingN"><strong>2.</strong> Get rid of the bad input.</p>
<p class="indenthandingN"><strong>3.</strong> Prompt the user to try again.</p>
<p>Note that the program has to reset <code>cin</code> before getting rid of the bad input. <a href="#ch06ex14">Listing 6.14</a> shows how these tasks can be accomplished.</p>
<p class="caption1"><a id="ch06ex14"/><strong>Listing 6.14. <code>cingolf.cpp</code></strong></p><hr/>
<p class="programlisting1">// cingolf.cpp -- non-numeric input skipped<br/>#include &lt;iostream&gt;<br/>const int Max = 5;<br/>int main()<br/>{<br/>&#160;&#160;&#160;&#160;using namespace std;<br/>// get data<br/>&#160;&#160;&#160;&#160;int golf[Max];<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "Please enter your golf scores.\n";<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "You must enter " &lt;&lt; Max &lt;&lt; " rounds.\n";<br/>&#160;&#160;&#160;&#160;int i;<br/>&#160;&#160;&#160;&#160;for (i = 0; i &lt; Max; i++)<br/>&#160;&#160;&#160;&#160;{<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cout &lt;&lt; "round #" &lt;&lt; i+1 &lt;&lt; ": ";<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;while (!(cin &gt;&gt; golf[i])) {<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cin.clear();&#160;&#160;&#160;&#160;&#160;// reset input<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;while (cin.get() != '\n')<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;continue;&#160;&#160;&#160;&#160;// get rid of bad input<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cout &lt;&lt; "Please enter a number: ";<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;}<br/>&#160;&#160;&#160;&#160;}<br/>// calculate average<br/>&#160;&#160;&#160;&#160;double total = 0.0;<br/>&#160;&#160;&#160;&#160;for (i = 0; i &lt; Max; i++)<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;total += golf[i];<br/>// report results<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; total / Max &lt;&lt; " = average score "<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;&lt; Max &lt;&lt; " rounds\n";<br/>&#160;&#160;&#160;&#160;return 0;<br/>}</p><hr/>
<p><a id="page_286"/>Here is a sample run of the program in <a href="#ch06ex14">Listing 6.14</a>:</p>
<p class="programlisting">Please enter your golf scores.<br/>You must enter 5 rounds.<br/>round #1: <span class="EmpStrong">88</span><br/>round #2: <span class="EmpStrong">87</span><br/>round #3: <span class="EmpStrong">must i?</span><br/>Please enter a number: <span class="EmpStrong">103</span><br/>round #4: <span class="EmpStrong">94</span><br/>round #5: <span class="EmpStrong">86</span><br/>91.6 = average score 5 rounds</p>
<h4 id="ch06lev2sec13">Program Notes</h4>
<p>The heart of the error-handling code in <a href="#ch06ex14">Listing 6.14</a> is the following:</p>
<p class="programlisting">while (!(cin &gt;&gt; golf[i])) {<br/>&#160;&#160;&#160;&#160;cin.clear();&#160;&#160;&#160;&#160;&#160;// reset input<br/>&#160;&#160;&#160;&#160;while (cin.get() != '\n')<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;continue; // get rid of bad input<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "Please enter a number: ";<br/>}</p>
<p>If the user enters <strong><code>88</code></strong>, the <code>cin</code> expression is <code>true</code>, and a value is placed in the array. Furthermore, because <code>cin</code> is <code>true</code>, the expression <code>!(cin &gt;&gt; golf[i])</code> is <code>false</code>, and this inner loop terminates. But if the user enters <strong><code>must i?</code></strong>, the <code>cin</code> expression is <code>false</code>, nothing is placed into the array, the expression <code>!(cin &gt;&gt; golf[i])</code> is <code>true</code>, and the program enters the inner <code>while</code> loop. The first statement in the loop uses the <code>clear()</code> method to reset input. If you omit this statement, the program refuses to read any more input. Next, the program uses <code>cin.get()</code> in a <code>while</code> loop to read the remaining input through the end of the line. This gets rid of the bad input, along with anything else on the line. Another approach is to read to the next whitespace, which gets rid of bad input one word at a time instead of one line at a time. Finally, the program tells the user to enter a number.</p>
<h3 id="ch06lev1sec8">Simple File Input/Output</h3>
<p><a id="page_287"/>Sometimes keyboard input is not the best choice. For example, suppose you&#8217;ve written a program to analyze stocks, and you&#8217;ve downloaded a file of 1,000 stock prices. It would be far more convenient to have the program read the file directly than to hand-enter all the values. Similarly, it can be convenient to have a program write output to a file so that you have a permanent record of the results.</p>
<p>Fortunately, C++ makes it simple to transfer the skills you&#8217;ve acquired for keyboard input and display output (collectively termed <em>console I/O</em>) to file input and output (<em>file I/O</em>). <a href="ch17.html#ch17">Chapter 17</a> explores these topics more extensively, but we&#8217;ll look at simple text file I/O now.</p>
<h4 id="ch06lev2sec14">Text I/O and Text Files</h4>
<p>Let&#8217;s re-examine the concept of text <em>I/O</em>. When you use <code>cin</code> for input, the program views input as a series of bytes, with each byte being interpreted as a character code. No matter what the destination data type, the input begins as character data&#8212;that is, text data. The <code>cin</code> object then has the responsibility of translating text to other types. To see how this works, let&#8217;s examine how different code handles the same line of input.</p>
<p>Suppose you have the following sample line of input:</p>
<p class="programlisting"><span class="EmpStrong">38.5 19.2</span></p>
<p>Let&#8217;s see how this line of input is handled by <code>cin</code> when used with different data types. First, let&#8217;s try type <code>char</code>:</p>
<p class="programlisting">char ch;<br/>cin &gt;&gt; ch;</p>
<p>The first character in the input line is assigned to <code>ch</code>. In this case, the first character is the digit <code>3</code>, and the character code (in binary) for this digit is stored in <code>ch</code>. The input and the destination are both characters, so no translation is needed. (Note that it&#8217;s not the numeric value <code>3</code> that is stored; rather, it is the character code for the digit 3.) After the input statement, the digit character <code>8</code> is the next character in the input queue and will be the next character examined by the next input operation.</p>
<p>Next, let&#8217;s try the <code>int</code> type with the same input:</p>
<p class="programlisting">int n;<br/>cin &gt;&gt; n;</p>
<p>In this case, <code>cin</code> reads up to the first non-digit character. That is, it reads the <code>3</code> digit and the <code>8</code> digit, leaving the period as the next character in the input queue. Then <code>cin</code> computes that these two characters correspond to the numeric value <code>38</code>, and the binary code for <code>38</code> is copied to <code>n</code>.</p>
<p>Next, let&#8217;s try the <code>double</code> type:</p>
<p class="programlisting">double x;<br/>cin &gt;&gt; x;</p>
<p><a id="page_288"/>In this case, <code>cin</code> reads up to the first character that&#8217;s not part of a floating-point number. That is, it reads the <code>3</code> digit, the <code>8</code> digit, the period character, and the <code>5</code> digit, leaving the space as the next character in the input queue. Then <code>cin</code> computes that these four characters correspond to the numeric value <code>38.5</code>, and the binary code (floating-point format) for 38.5 is copied to <code>x</code>.</p>
<p>Next, let&#8217;s try the <code>char</code> array type:</p>
<p class="programlisting">char word[50];<br/>cin &gt;&gt; word;</p>
<p>In this case, <code>cin</code> reads up to the whitespace character. That is, it reads the <code>3</code> digit, the <code>8</code> digit, the period character, and the <code>5</code> digit, leaving the space as the next character in the input queue. Then <code>cin</code> stores the character code for these four characters in the array <code>word</code> and adds a terminating null character. No translation is needed.</p>
<p>Finally, let&#8217;s try an input variant for the <code>char</code> array type:</p>
<p class="programlisting">char word[50];<br/>cin.geline(word,50);</p>
<p>In this case, <code>cin</code> reads up through the newline character (the sample input line had fewer than 50 characters). All the characters through the final <code>2</code> digit are stored in the array <code>word</code>, and a null character is added. The newline character is discarded, and the next character in the input queue will be the first character on the next line. No translation is needed.</p>
<p>On output, the opposite translations take place. That is, integers are converted to sequences of digit characters, and floating-point numbers are converted to sequences of digits and other characters (for example, 284.53 or -1.587E+06). Character data requires no translation.</p>
<p>The main point to this is that all the input starts out as text. Therefore, the file equivalent to console input is a text file&#8212;that is, a file in which each byte stores a character code. Not all files are text files. For example, databases and spreadsheets store numeric data in numeric forms&#8212;that is, in binary integer or binary floating-point form. Also, word processing files may contain text information, but they also contain non-text data to describe formatting, fonts, printers, and the like.</p>
<p>The file I/O discussed in this chapter parallels console I/O and thus should be used with text files. To create a text file for input, you use a text editor, such as Notepad for Windows, or vi or emacs for Unix/Linux. You can use a word processor, as long as you save the file in text format. The code editors that are part of IDEs also produce text files; indeed, the source code files are examples of text files. Similarly, you can use text editors to look at files created with text output.</p>
<h4 id="ch06lev2sec15">Writing to a Text File</h4>
<p>For file output, C++ uses analogs to <code>cout</code>. So to prepare for file output, let&#8217;s review some basic facts about using <code>cout</code> for console output:</p>
<p class="indenthandingB">&#8226; <a id="page_289"/>You must include the <code>iostream</code> header file.</p>
<p class="indenthandingB">&#8226; The <code>iostream</code> header file defines an <code>ostream</code> class for handling output.</p>
<p class="indenthandingB">&#8226; The <code>iostream</code> header file declares an <code>ostream</code> variable, or object, called <code>cout</code>.</p>
<p class="indenthandingB">&#8226; You must account for the <code>std</code> namespace; for example, you can use the <code>using</code> directive or the <code>std::</code> prefix for elements such as <code>cout</code> and <code>endl</code>.</p>
<p class="indenthandingB">&#8226; You can use <code>cout</code> with the <code>&lt;&lt;</code> operator to read a variety of data types.</p>
<p>File output parallels this very closely:</p>
<p class="indenthandingB">&#8226; You must include the <code>fstream</code> header file.</p>
<p class="indenthandingB">&#8226; The <code>fstream</code> header file defines an <code>ofstream</code> class for handling output.</p>
<p class="indenthandingB">&#8226; You need to declare one or more <code>ofstream</code> variables, or objects, which you can name as you please, as long as you respect the usual naming conventions.</p>
<p class="indenthandingB">&#8226; You must account for the <code>std</code> namespace; for example, you can use the <code>using</code> directive or the <code>std::</code> prefix for elements such as <code>ofstream</code>.</p>
<p class="indenthandingB">&#8226; You need to associate a specific <code>ofstream</code> object with a specific file; one way to do so is to use the <code>open()</code> method.</p>
<p class="indenthandingB">&#8226; When you&#8217;re finished with a file, you should use the <code>close()</code> method to close the file.</p>
<p class="indenthandingB">&#8226; You can use an <code>ofstream</code> object with the <code>&lt;&lt;</code> operator to output a variety of data types.</p>
<p>Note that although the <code>iostream</code> header file provides a predefined <code>ostream</code> object called <code>cout</code>, you have to declare your own <code>ofstream</code> object, choosing a name for it and associating it with a file. Here&#8217;s how you declare such objects:</p>
<p class="programlisting">ofstream outFile;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// outFile an ofstream object<br/>ofstream fout;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// fout an ofstream object</p>
<p>Here&#8217;s how you can associate the objects with particular files:</p>
<p class="programlisting">outFile.open("fish.txt");&#160;&#160;&#160;// outFile used to write to the fish.txt file<br/>char filename[50];<br/>cin &gt;&gt; filename;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// user specifies a name<br/>fout.open(filename);&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// fout used to read specified file</p>
<p>Note that the <code>open()</code> method requires a C-style string as its argument. This can be a literal string or a string stored in an array.</p>
<p>Here&#8217;s how you can use these objects:</p>
<p class="programlisting">double wt = 125.8;<br/>outFile &lt;&lt; wt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// write a number to fish.txt<br/>char line[81] = "Objects are closer than they appear.";<br/>fout &lt;&lt; line &lt;&lt; endl;&#160;&#160;&#160;// write a line of text</p>
<p>The important point is that after you&#8217;ve declared an <code>ofstream</code> object and associated it with a file, you use it exactly as you would use <code>cout</code>. All the operations and methods <a id="page_290"/>available to <code>cout</code>, such as <code>&lt;&lt;</code>, <code>endl</code>, and <code>setf()</code>, are also available to <code>ofstream</code> objects, such as <code>outFile</code> and <code>fout</code> in the preceding examples.</p>
<p>In short, these are the main steps for using file output:</p>
<p class="indenthandingN"><strong>1.</strong> Include the <code>fstream</code> header file.</p>
<p class="indenthandingN"><strong>2.</strong> Create an <code>ofstream</code> object.</p>
<p class="indenthandingN"><strong>3.</strong> Associate the <code>ofstream</code> object with a file.</p>
<p class="indenthandingN"><strong>4.</strong> Use the <code>ofstream</code> object in the same manner you would use <code>cout</code>.</p>
<p>The program in <a href="#ch06ex15">Listing 6.15</a> demonstrates this approach. It solicits information from the user, sends output to the display, and then sends the same output to a file. You can use a text editor to examine the output file.</p>
<p class="caption1"><a id="ch06ex15"/><strong>Listing 6.15. <code>outfile.cpp</code></strong></p><hr/>
<p class="programlisting1">// outfile.cpp -- writing to a file<br/>#include &lt;iostream&gt;<br/>#include &lt;fstream&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// for file I/O<br/><br/>int main()<br/>{<br/>&#160;&#160;&#160;&#160;using namespace std;<br/><br/>&#160;&#160;&#160;&#160;char automobile[50];<br/>&#160;&#160;&#160;&#160;int year;<br/>&#160;&#160;&#160;&#160;double a_price;<br/>&#160;&#160;&#160;&#160;double d_price;<br/><br/>&#160;&#160;&#160;&#160;ofstream outFile;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// create object for output<br/>&#160;&#160;&#160;&#160;outFile.open("carinfo.txt");&#160;&#160;&#160;&#160;// associate with a file<br/><br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "Enter the make and model of automobile: ";<br/>&#160;&#160;&#160;&#160;cin.getline(automobile, 50);<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "Enter the model year: ";<br/>&#160;&#160;&#160;&#160;cin &gt;&gt; year;<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "Enter the original asking price: ";<br/>&#160;&#160;&#160;&#160;cin &gt;&gt; a_price;<br/>&#160;&#160;&#160;&#160;d_price = 0.913 * a_price;<br/><br/>// display information on screen with cout<br/><br/>&#160;&#160;&#160;&#160;cout &lt;&lt; fixed;<br/>&#160;&#160;&#160;&#160;cout.precision(2);<br/>&#160;&#160;&#160;&#160;cout.setf(ios_base::showpoint);<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "Make and model: " &lt;&lt; automobile &lt;&lt; endl;<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "Year: " &lt;&lt; year &lt;&lt; endl;<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "Was asking $" &lt;&lt; a_price &lt;&lt; endl;<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "Now asking $" &lt;&lt; d_price &lt;&lt; endl;<br/><br/>// now do exact same things using outFile instead of cout<br/><br/>&#160;&#160;&#160;&#160;outFile &lt;&lt; fixed;<br/>&#160;&#160;&#160;&#160;outFile.precision(2);<br/>&#160;&#160;&#160;&#160;outFile.setf(ios_base::showpoint);<br/>&#160;&#160;&#160;&#160;outFile &lt;&lt; "Make and model: " &lt;&lt; automobile &lt;&lt; endl;<br/>&#160;&#160;&#160;&#160;outFile &lt;&lt; "Year: " &lt;&lt; year &lt;&lt; endl;<br/>&#160;&#160;&#160;&#160;outFile &lt;&lt; "Was asking $" &lt;&lt; a_price &lt;&lt; endl;<br/>&#160;&#160;&#160;&#160;outFile &lt;&lt; "Now asking $" &lt;&lt; d_price &lt;&lt; endl;<br/><br/>&#160;&#160;&#160;&#160;outFile.close();&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// done with file<br/>&#160;&#160;&#160;&#160;return 0;<br/>}</p><hr/>
<p><a id="page_291"/>Note that the final section of the program in <a href="#ch06ex15">Listing 6.15</a> duplicates the <code>cout</code> section, with <code>cout</code> replaced by <code>outFile</code>. Here is a sample run of this program:</p>
<p class="programlisting">Enter the make and model of automobile: Flitz Perky<br/>Enter the model year: 2009<br/>Enter the original asking price: 13500<br/>Make and model: Flitz Perky<br/>Year: 2009<br/>Was asking $13500.00<br/>Now asking $12325.50</p>
<p>The screen output comes from using <code>cout</code>. If you check the directory or folder that contains the executable program, you should find a new file called <code>carinfo.txt</code>. (Or it may be in some other folder, depending on how the compiler is configured.) It contains the output generated by using <code>outFile</code>. If you open it with a text editor, you should find the following contents:</p>
<p class="programlisting">Make and model: Flitz Perky<br/>Year: 2009<br/>Was asking $13500.00<br/>Now asking $12325.50</p>
<p>As you can see, <code>outFile</code> sends precisely the same sequence of characters to the <code>carinfo.txt</code> file that <code>cout</code> sends to the display.</p>
<h5 id="ch06lev3sec4">Program Notes</h5>
<p>After the program in <a href="#ch06ex15">Listing 6.15</a> declares an <code>ofstream</code> object, you can use the <code>open()</code> method to associate the object with a particular file:</p>
<p class="programlisting">ofstream outFile;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// create object for output<br/>outFile.open("carinfo.txt");&#160;&#160;&#160;&#160;// associate with a file</p>
<p><a id="page_292"/>When the program is done using a file, it should close the connection:</p>
<p class="programlisting">outFile.close();</p>
<p>Notice that the <code>close()</code> method doesn&#8217;t require a filename. That&#8217;s because <code>outFile</code> has already been associated with a particular file. If you forget to close a file, the program will close it automatically if the program terminates normally.</p>
<p>Notice that <code>outFile</code> can use the same methods that <code>cout</code> does. Not only can it use the <code>&lt;&lt;</code> operator, but it can use the various formatting methods, such as <code>setf()</code> and <code>precision()</code>. These methods affect only the object that invokes the method. For example, you can provide different values for different objects:</p>
<p class="programlisting">cout.precision(2);&#160;&#160;&#160;&#160;&#160;&#160;&#160;// use a precision of 2 for the display<br/>outFile.precision(4);&#160;&#160;&#160;&#160;// use a precision of 4 for file output</p>
<p>The main point you should remember is that after you set up an <code>ofstream</code> object such as <code>outFile</code>, you use it in precisely the same matter as you use <code>cout</code>.</p>
<p>Let&#8217;s go back to the <code>open()</code> method:</p>
<p class="programlisting">outFile.open("carinfo.txt");</p>
<p>In this case, the file <code>carinfo.txt</code> does not exist before the program runs. In this circumstance, the <code>open()</code> method creates a brand new file by that name. When the file <code>carinfo.txt</code> exists, what happens if you run the program again? By default, <code>open()</code> first truncates the file; that is, it trims <code>carinfo.txt</code> to zero length, discarding the current contents. The contents are then replaced with the new output. <a href="ch17.html#ch17">Chapter 17</a> reveals how to override this default behavior.</p>
<div class="note"><hr/>
<p class="title"><a id="ch06note04"/>Caution</p>
<p class="notepara">When you open an existing file for output, by default it is truncated to a length of zero bytes, so the contents are lost.</p>
<hr/></div>
<p>It is possible that an attempt to open a file for output might fail. For example, a file having the requested name might already exist and have restricted access. Therefore, a careful programmer would check to see if the attempt succeeded. You&#8217;ll learn the technique for this in the next example.</p>
<h4 id="ch06lev2sec16">Reading from a Text File</h4>
<p>Next, let&#8217;s examine text file input. It&#8217;s based on console input, which has many elements. So let&#8217;s begin with a summary those elements:</p>
<p class="indenthandingB">&#8226; You must include the <code>iostream</code> header file.</p>
<p class="indenthandingB">&#8226; The <code>iostream</code> header file defines an <code>istream</code> class for handling input.</p>
<p class="indenthandingB">&#8226; The <code>iostream</code> header file declares an <code>istream</code> variable, or object, called <code>cin</code>.</p>
<p class="indenthandingB">&#8226; You must account for the <code>std</code> namespace; for example, you can use the <code>using</code> directive or the <code>std::</code> prefix for elements such as <code>cin</code>.</p>
<p class="indenthandingB">&#8226; <a id="page_293"/>You can use <code>cin</code> with the <code>&gt;&gt;</code> operator to read a variety of data types.</p>
<p class="indenthandingB">&#8226; You can use <code>cin</code> with the <code>get()</code> method to read individual characters and with the <code>getline()</code> method to read a line of characters at a time.</p>
<p class="indenthandingB">&#8226; You can use <code>cin</code> with methods such as <code>eof()</code> and <code>fail()</code> to monitor the success of an input attempt.</p>
<p class="indenthandingB">&#8226; The object <code>cin</code> itself, when used as a test condition, is converted to the Boolean value <code>true</code> if the last read attempt succeeded and to <code>false</code> otherwise.</p>
<p>File input parallels this very closely:</p>
<p class="indenthandingB">&#8226; You must include the <code>fstream</code> header file.</p>
<p class="indenthandingB">&#8226; The <code>fstream</code> header file defines an <code>ifstream</code> class for handling input.</p>
<p class="indenthandingB">&#8226; You need to declare one or more <code>ifstream</code> variables, or objects, which you can name as you please, as long as you respect the usual naming conventions.</p>
<p class="indenthandingB">&#8226; You must account for the <code>std</code> namespace; for example, you can use the <code>using</code> directive or the <code>std::</code> prefix for elements such as <code>ifstream</code>.</p>
<p class="indenthandingB">&#8226; You need to associate a specific <code>ifstream</code> object with a specific file; one way to do so is to use the <code>open()</code> method.</p>
<p class="indenthandingB">&#8226; When you&#8217;re finished with a file, you should use the <code>close()</code> method to close the file.</p>
<p class="indenthandingB">&#8226; You can use an <code>ifstream</code> object with the <code>&gt;&gt;</code> operator to read a variety of data types.</p>
<p class="indenthandingB">&#8226; You can use an <code>ifstream</code> object with the <code>get()</code> method to read individual characters and with the <code>getline()</code> method to read a line of characters at a time.</p>
<p class="indenthandingB">&#8226; You can use an <code>ifstream</code> object with methods such as <code>eof()</code> and <code>fail()</code> to monitor the success of an input attempt.</p>
<p class="indenthandingB">&#8226; An <code>ifstream</code> object itself, when used as a test condition, is converted to the Boolean value <code>true</code> if the last read attempt succeeded and to <code>false</code> otherwise.</p>
<p>Note that although the <code>iostream</code> header file provides a predefined <code>istream</code> object called <code>cin</code>, you have to declare your own <code>ifstream</code> object, choosing a name for it and associating it with a file. Here&#8217;s how you declare such objects:</p>
<p class="programlisting">ifstream inFile;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// inFile an ifstream object<br/>ifstream fin;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// fin an ifstream object</p>
<p>Here&#8217;s how you can associate them with particular files:</p>
<p class="programlisting">inFile.open("bowling.txt");&#160;&#160;// inFile used to read bowling.txt file<br/>char filename[50];<br/>cin &gt;&gt; filename;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// user specifies a name<br/>fin.open(filename);&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// fin used to read specified file</p>
<p>Note that the <code>open()</code> method requires a C-style string as its argument. This can be a literal string or a string stored in an array.</p>
<p><a id="page_294"/>Here&#8217;s how you can use these objects:</p>
<p class="programlisting">double wt;<br/>inFile &gt;&gt; wt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// read a number from bowling.txt<br/>char line[81];<br/>fin.getline(line, 81); // read a line of text</p>
<p>The important point is that after you&#8217;ve declared an <code>ifstream</code> object and associated it with a file, you can use it exactly as you would use <code>cin</code>. All the operations and methods available to <code>cin</code> are also available to <code>ifstream</code> objects, such as <code>inFile</code> and <code>fin</code> in the preceding examples.</p>
<p>What happens if you attempt to open a non-existent file for input? This error causes subsequent attempts to use the <code>ifstream</code> object for input to fail. The preferred way to check whether a file was opened successfully is to use the <code>is_open()</code> method. You can use code like this:</p>
<p class="programlisting">inFile.open("bowling.txt");<br/>if (!inFile.is_open())<br/>{<br/>&#160;&#160;&#160;&#160;exit(EXIT_FAILURE);<br/>}</p>
<p>The <code>is_open()</code> method returns <code>true</code> if the file was opened successfully, so the expression <code>!inFile.is_open()</code> is <code>true</code> if the attempt fails. The <code>exit()</code> function is prototyped in the <code>cstdlib</code> header file, which also defines <code>EXIT_FAILURE</code> as an argument value used to communicate with the operating system. The <code>exit()</code> function terminates the program.</p>
<p>The <code>is_open()</code> method is relatively new to C++. If your compiler doesn&#8217;t support it, you can use the older <code>good()</code> method instead. As <a href="ch17.html#ch17">Chapter 17</a> discusses, <code>good()</code> doesn&#8217;t check quite as extensively as <code>is_open()</code> for possible problems.</p>
<p>The program in <a href="#ch06ex16">Listing 6.16</a> opens a file specified by the user, reads numbers from the file, and reports the number of values, their sum, and their average. It&#8217;s important that you design the input loop correctly, and the following &#8220;<a href="#ch06lev3sec5">Program Notes</a>&#8221; section discusses this in more detail. Notice that this program benefits greatly from using <code>if</code> statements.</p>
<p class="caption1"><a id="ch06ex16"/><strong>Listing 6.16. <code>sumafile.cpp</code></strong></p><hr/>
<p class="programlisting1">// sumafile.cpp -- functions with an array argument<br/>#include &lt;iostream&gt;<br/>#include &lt;fstream&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// file I/O support<br/>#include &lt;cstdlib&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// support for exit()<br/>const int SIZE = 60;<br/>int main()<br/>{<br/>&#160;&#160;&#160;&#160;using namespace std;<br/>&#160;&#160;&#160;&#160;char filename[SIZE];<br/>&#160;&#160;&#160;&#160;ifstream inFile;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// object for handling file input<br/><br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "Enter name of data file: ";<br/>&#160;&#160;&#160;&#160;cin.getline(filename, SIZE);<br/>&#160;&#160;&#160;&#160;inFile.open(filename);&#160;&#160;// associate inFile with a file<br/>&#160;&#160;&#160;&#160;if (!inFile.is_open())&#160;&#160;// failed to open file<br/>&#160;&#160;&#160;&#160;{<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cout &lt;&lt; "Could not open the file " &lt;&lt; filename &lt;&lt; endl;<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cout &lt;&lt; "Program terminating.\n";<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;exit(EXIT_FAILURE);<br/>&#160;&#160;&#160;&#160;}<br/>&#160;&#160;&#160;&#160;double value;<br/>&#160;&#160;&#160;&#160;double sum = 0.0;<br/>&#160;&#160;&#160;&#160;int count = 0;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// number of items read<br/><br/>&#160;&#160;&#160;&#160;inFile &gt;&gt; value;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// get first value<br/>&#160;&#160;&#160;&#160;while (inFile.good())&#160;&#160;&#160;// while input good and not at EOF<br/>&#160;&#160;&#160;&#160;{<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;++count;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// one more item read<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;sum += value;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// calculate running total<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;inFile &gt;&gt; value;&#160;&#160;&#160;&#160;// get next value<br/>&#160;&#160;&#160;&#160;}<br/>&#160;&#160;&#160;&#160;if (inFile.eof())<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cout &lt;&lt; "End of file reached.\n";<br/>&#160;&#160;&#160;&#160;else if (inFile.fail())<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cout &lt;&lt; "Input terminated by data mismatch.\n";<br/>&#160;&#160;&#160;&#160;else<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cout &lt;&lt; "Input terminated for unknown reason.\n";<br/>&#160;&#160;&#160;&#160;if (count == 0)<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cout &lt;&lt; "No data processed.\n";<br/>&#160;&#160;&#160;&#160;else<br/>&#160;&#160;&#160;&#160;{<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cout &lt;&lt; "Items read: " &lt;&lt; count &lt;&lt; endl;<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cout &lt;&lt; "Sum: " &lt;&lt; sum &lt;&lt; endl;<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cout &lt;&lt; "Average: " &lt;&lt; sum / count &lt;&lt; endl;<br/>&#160;&#160;&#160;&#160;}<br/>&#160;&#160;&#160;&#160;inFile.close();&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// finished with the file<br/>&#160;&#160;&#160;&#160;return 0;<br/>}</p><hr/>
<p><a id="page_295"/>To use the program in <a href="#ch06ex16">Listing 6.16</a>, you first have to create a text file that contains numbers. You can use a text editor, such as the text editor you use to write source code, to create this file. Let&#8217;s assume that the file is called <code>scores.txt</code> and has the following contents:</p>
<p class="programlisting">18 19 18.5 13.5 14<br/>16 19.5 20 18 12 18.5<br/>17.5</p>
<p><a id="page_296"/>The program has to be able to find the file. Typically, unless your input includes a pathname with the file, the program will look in the same folder or directory that contains the executable file.</p>
<div class="note"><hr/>
<p class="title"><a id="ch06note05"/>Caution</p>
<p class="notepara">A Windows text file uses the carriage return character followed by a linefeed character to terminate a line of text. (The usual C++ text mode translates this combination to newline character when reading a file and reverses the translation when writing to a file.) Some text editors, such as the Metrowerks CodeWarrior IDE editor, don&#8217;t automatically add a this combination to the final line. Therefore, if you use such an editor, you need to press the Enter key after typing the final text and before exiting the file.</p>
<hr/></div>
<p>Here&#8217;s a sample run of the program in <a href="#ch06ex16">Listing 6.16</a>:</p>
<p class="programlisting">Enter name of data file: <span class="EmpStrong">scores.txt</span><br/>End of file reached.<br/>Items read: 12<br/>Sum: 204.5<br/>Average: 17.0417</p>
<h5 id="ch06lev3sec5">Program Notes</h5>
<p>Instead of hard-coding a filename, the program in <a href="#ch06ex16">Listing 6.16</a> stores a user-supplied name in the character array <code>filename</code>. Then the array is used as an argument to <code>open()</code>:</p>
<p class="programlisting">inFile.open(filename);</p>
<p>As discussed earlier in this chapter, it&#8217;s vital to test whether the attempt to open the file succeeded. Here are a few of the things that might go wrong: The file might not exist, the file might be located in another directory or file folder, access might be denied, and the user might mistype the name or omit a file extension. Many a beginner has spent a long time trying to figure what&#8217;s wrong with a file-reading loop when the real problem was that the program didn&#8217;t open the file. Testing for file-opening failure can save you such misspent effort.</p>
<p>You need to pay close attention to the proper design of a file-reading loop. There are several things to test for when reading from a file. First, the program should not try to read past the EOF. The <code>eof()</code> method returns <code>true</code> if the most recent attempt to read data ran into the EOF. Second, the program might encounter a type mismatch. For instance, <a href="#ch06ex16">Listing 6.16</a> expects a file containing only numbers. The <code>fail()</code> method returns <code>true</code> if the most recent read attempt encountered a type mismatch. (This method also returns <code>true</code> if the EOF is encountered.) Finally, something unexpected may go wrong&#8212;for example, a corrupted file or a hardware failure. The <code>bad()</code> method returns <code>true</code> if the most recent read attempt encountered such a problem. Rather than test for these conditions individually, it&#8217;s simpler to use the <code>good()</code> method, which returns <code>true</code> if nothing when wrong:</p>
<p class="programlisting"><a id="page_297"/>while (inFile.good())&#160;&#160;&#160;// while input good and not at EOF<br/>{<br/>&#160;&#160;&#160;&#160;...<br/>}</p>
<p>Then, if you like, you can use the other methods to determine exactly why the loop terminated:</p>
<p class="programlisting">if (inFile.eof())<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "End of file reached.\n";<br/>else if (inFile.fail())<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "Input terminated by data mismatch.\n";<br/>else<br/>&#160;&#160;&#160;&#160;cout &lt;&lt; "Input terminated for unknown reason.\n";</p>
<p>This code comes immediately after the loop so that it investigates why the loop terminated. Because <code>eof()</code> tests just for the EOF and <code>fail()</code> tests for both the EOF and type mismatch, this code tests for the EOF first. That way, if execution reaches the <code>else if</code> test, the EOF has already been excluded, so a <code>true</code> value for <code>fail()</code> unambiguously identifies type mismatch as the cause of loop termination.</p>
<p>It&#8217;s particularly important that you understand that <code>good()</code> reports on the most recent attempt to read input. That means there should be an attempt to read input <em>immediately</em> before applying the test. A standard way of doing that is to have one input statement immediately before the loop, just before the first execution of the loop test, and a second input statement at the end of the loop, just before subsequent executions of the loop test:</p>
<p class="programlisting">// standard file-reading loop design<br/>inFile &gt;&gt; value;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// get first value<br/>while (inFile.good())&#160;&#160;&#160;// while input good and not at EOF<br/>{<br/>&#160;&#160;&#160;&#160;// loop body goes here<br/>&#160;&#160;&#160;&#160;inFile &gt;&gt; value;&#160;&#160;&#160;&#160;// get next value<br/>}</p>
<p>You can condense this somewhat by using the fact that the following expression evaluates to <code>inFile</code> and that <code>inFile</code>, when placed in a context in which a <code>bool</code> value is expected, evaluates to <code>inFile.good()</code>&#8212;that is, to <code>true</code> or <code>false</code>:</p>
<p class="programlisting">inFile &gt;&gt; value</p>
<p>Thus, you can replace the two input statements with a single input statement used as a loop test. That is, you can replace the preceding loop structure with this:</p>
<p class="programlisting">// abbreviated file-reading loop design<br/>// omit pre-loop input<br/>while (inFile &gt;&gt; value)&#160;&#160;&#160;// read and test for success<br/>{<br/>&#160;&#160;&#160;&#160;// loop body goes here<br/>&#160;&#160;&#160;&#160;// omit end-of-loop input<br/>}</p>
<p><a id="page_298"/>This design still follows the precept of attempting to read before testing because to evaluate the expression <code>inFile &gt;&gt; value</code>, the program first has to attempt to read a number into <code>value</code>.</p>
<p>Now you know the rudiments of file I/O.</p>
<h3 id="ch06lev1sec9">Summary</h3>
<p>Programs and programming become more interesting when you introduce statements that guide the program through alternative actions. (Whether this also makes the programmer more interesting is a point you may wish to investigate.) C++ provides the <code>if</code> statement, the <code>if else</code> statement, and the <code>switch</code> statement as means for managing choices. The C++ <code>if</code> statement lets a program execute a statement or statement block conditionally. That is, the program executes the statement or block if a particular condition is met. The C++ <code>if else</code> statement lets a program select from two choices which statement or statement block to execute. You can append additional <code>if else</code> statements to such a statement to present a series of choices. The C++ <code>switch</code> statement directs the program to a particular case in a list of choices.</p>
<p>C++ also provides operators to help in decision making. <a href="ch05.html#ch05">Chapter 5</a> discusses the relational expressions, which compare two values. The <code>if</code> and <code>if else</code> statements typically use relational expressions as test conditions. By using C++&#8217;s logical operators (<code>&#38;&#38;</code>, <code>||</code>, and <code>!</code>), you can combine or modify relational expressions to construct more elaborate tests. The conditional operator (<code>?:</code>) provides a compact way to choose from two values.</p>
<p>The <code>cctype</code> library of character functions provides a convenient and powerful set of tools for analyzing character input.</p>
<p>Loops and selection statements are useful tools for file I/O, which closely parallels console I/O. After you declare <code>ifstream</code> and <code>ofstream</code> objects and associate them with files, you can use these objects in the same manner you use <code>cin</code> and <code>cout</code>.</p>
<p>With C++&#8217;s loops and decision-making statements, you have the tools for writing interesting, intelligent, and powerful programs. But we&#8217;ve only begun to investigate the real powers of C++. Next, we&#8217;ll look at functions.</p>
<h3 id="ch06lev1sec10">Chapter Review</h3>
<p class="question"><a id="ch06qa1q1" href="app10.html#ch06qa1a1"><strong>1.</strong></a> Consider the following two code fragments for counting spaces and newlines:</p>
<p class="programlistingB">// Version 1<br/>while (cin.get(ch))&#160;&#160;&#160;&#160;// quit on eof<br/>{<br/>&#160;&#160;&#160;&#160;&#160;&#160;if (ch == ' ')<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;spaces++;<br/>&#160;&#160;&#160;&#160;&#160;&#160;if (ch == '\n')<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;newlines++;<br/>}<br/><br/>// Version 2<br/><a id="page_299"/>while (cin.get(ch))&#160;&#160;&#160;&#160;// quit on eof<br/>{<br/>&#160;&#160;&#160;&#160;&#160;&#160;if (ch == ' ')<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;spaces++;<br/>&#160;&#160;&#160;&#160;&#160;&#160;else if (ch == '\n')<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;newlines++;<br/>}</p>
<p class="questionp">What advantages, if any, does the second form have over the first?</p>
<p class="question"><a id="ch06qa1q2" href="app10.html#ch06qa1a2"><strong>2.</strong></a> In <a href="#ch06ex02">Listing 6.2</a>, what is the effect of replacing <code>++ch</code> with <code>ch+1</code>?</p>
<p class="question"><a id="ch06qa1q3" href="app10.html#ch06qa1a3"><strong>3.</strong></a> Carefully consider the following program:</p>
<p class="programlistingB">#include &lt;iostream&gt;<br/>using namespace std;<br/>int main()<br/>{<br/>&#160;&#160;&#160;&#160;char ch;<br/>&#160;&#160;&#160;&#160;int ct1, ct2;<br/><br/>&#160;&#160;&#160;&#160;ct1 = ct2 = 0;<br/>&#160;&#160;&#160;&#160;while ((ch = cin.get()) != '$')<br/>&#160;&#160;&#160;&#160;{<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cout &lt;&lt; ch;<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ct1++;<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if (ch = '$')<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ct2++;<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cout &lt;&lt; ch;<br/>&#160;&#160;&#160;&#160;}<br/>&#160;&#160;&#160;&#160;cout &lt;&lt;"ct1 = " &lt;&lt; ct1 &lt;&lt; ", ct2 = " &lt;&lt; ct2 &lt;&lt; "\n";<br/>&#160;&#160;&#160;&#160;return 0;<br/>}</p>
<p class="questionp">Suppose you provide the following input, pressing the Enter key at the end of each line:</p>
<p class="programlistingB"><span class="EmpStrong">Hi!</span><br/><span class="EmpStrong">Send $10 or $20 now!</span></p>
<p class="questionp">What is the output? (Recall that input is buffered.)</p>
<p class="question"><a id="ch06qa1q4" href="app10.html#ch06qa1a4"><strong>4.</strong></a> Construct logical expressions to represent the following conditions:</p>
<p class="indenthandinga"><strong>a.</strong> <code>weight</code> is greater than or equal to 115 but less than 125.</p>
<p class="indenthandinga"><strong>b.</strong> <code>ch</code> is <code>q</code> or <code>Q</code>.</p>
<p class="indenthandinga"><strong>c.</strong> <code>x</code> is even but is not <code>26</code>.</p>
<p class="indenthandinga"><strong>d.</strong> <code>x</code> is even but is not a multiple of <code>26</code>.</p>
<p class="indenthandinga"><strong>e.</strong> <code>donation</code> is in the range 1,000&#8211;2,000 or <code>guest</code> is <code>1</code>.</p>
<p class="indenthandinga"><strong>f.</strong> <a id="page_300"/><code>ch</code> is a lowercase letter or an uppercase letter. (Assume, as is true for ASCII, that lowercase letters are coded sequentially and that uppercase letters are coded sequentially but that there is a gap in the code between uppercase and lowercase.)</p>
<p class="question"><a id="ch06qa1q5" href="app10.html#ch06qa1a5"><strong>5.</strong></a> In English, the statement &#8220;I will not not speak&#8221; means the same as &#8220;I will speak.&#8221; In C++, is <code>!!x</code> the same as <code>x</code>?</p>
<p class="question"><a id="ch06qa1q6" href="app10.html#ch06qa1a6"><strong>6.</strong></a> Construct a conditional expression that is equal to the absolute value of a variable. That is, if a variable <code>x</code> is positive, the value of the expression is just <code>x</code>, but if <code>x</code> is negative, the value of the expression is <code>-x</code>, which is positive.</p>
<p class="question"><a id="ch06qa1q7" href="app10.html#ch06qa1a7"><strong>7.</strong></a> Rewrite the following fragment using <code>switch</code>:</p>
<p class="programlistingB">if (ch == 'A')<br/>&#160;&#160;&#160;&#160;a_grade++;<br/>else if (ch == 'B')<br/>&#160;&#160;&#160;&#160;b_grade++;<br/>else if (ch == 'C')<br/>&#160;&#160;&#160;&#160;c_grade++;<br/>else if (ch == 'D')<br/>&#160;&#160;&#160;&#160;d_grade++;<br/>else<br/>&#160;&#160;&#160;&#160;f_grade++;</p>
<p class="question"><a id="ch06qa1q8" href="app10.html#ch06qa1a8"><strong>8.</strong></a> In <a href="#ch06ex10">Listing 6.10</a>, what advantage would there be in using character labels, such as <code>a</code> and <code>c</code>, instead of numbers for the menu choices and switch cases? (Hint: Think about what happens if the user types <code>q</code> in either case and what happens if the user types <strong><code>5</code></strong> in either case.)</p>
<p class="question"><a id="ch06qa1q9" href="app10.html#ch06qa1a9"><strong>9.</strong></a> Consider the following code fragment:</p>
<p class="programlistingB">int line = 0;<br/>char ch;<br/>while (cin.get(ch))<br/>{<br/>&#160;&#160;&#160;&#160;if (ch == 'Q')<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;break;<br/>&#160;&#160;&#160;&#160;if (ch != '\n')<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;continue;<br/>&#160;&#160;&#160;&#160;line++;<br/>}</p>
<p class="questionp">Rewrite this code without using <code>break</code> or <code>continue</code>.</p>
<h3 id="ch06lev1sec11">Programming Exercises</h3>
<p class="question"><a id="page_301"/><a id="ch06qa2q1"/><strong>1.</strong> Write a program that reads keyboard input to the <code>@</code> symbol and that echoes the input except for digits, converting each uppercase character to lowercase, and vice versa. (Don&#8217;t forget the <code>cctype</code> family.)</p>
<p class="question"><a id="ch06qa2q2"/><strong>2.</strong> Write a program that reads up to 10 donation values into an array of <code>double</code>. (Or, if you prefer, use an <code>array</code> template object.) The program should terminate input on non-numeric input. It should report the average of the numbers and also report how many numbers in the array are larger than the average.</p>
<p class="question"><a id="ch06qa2q3"/><strong>3.</strong> Write a precursor to a menu-driven program. The program should display a menu offering four choices, each labeled with a letter. If the user responds with a letter other than one of the four valid choices, the program should prompt the user to enter a valid response until the user complies. Then the program should use a switch to select a simple action based on the user&#8217;s selection. A program run could look something like this:</p>
<p class="programlistingB">Please enter one of the following choices:<br/>c) carnivore&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;p) pianist<br/>t) tree&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;g) game<br/>f<br/>Please enter a c, p, t, or g: <span class="EmpStrong">q</span><br/>Please enter a c, p, t, or g: <span class="EmpStrong">t</span><br/>A maple is a tree.</p>
<p class="question"><a id="ch06qa2q4"/><strong>4.</strong> When you join the Benevolent Order of Programmers, you can be known at BOP meetings by your real name, your job title, or your secret BOP name. Write a program that can list members by real name, by job title, by secret name, or by a member&#8217;s preference. Base the program on the following structure:</p>
<p class="programlistingB">// Benevolent Order of Programmers name structure<br/>struct bop {<br/>&#160;&#160;&#160;&#160;char fullname[strsize]; // real name<br/>&#160;&#160;&#160;&#160;char title[strsize];&#160;&#160;&#160;&#160;// job title<br/>&#160;&#160;&#160;&#160;char bopname[strsize];&#160;&#160;// secret BOP name<br/>&#160;&#160;&#160;&#160;int preference;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// 0 = fullname, 1 = title, 2 = bopname<br/>};</p>
<p class="questionp">In the program, create a small array of such structures and initialize it to suitable values. Have the program run a loop that lets the user select from different alternatives:</p>
<p class="programlistingB">a. display by name&#160;&#160;&#160;&#160;&#160;b. display by title<br/>c. display by bopname&#160;&#160;d. display by preference<br/>q. quit</p>
<p class="questionp"><a id="page_302"/>Note that &#8220;display by preference&#8221; does not mean display the preference member; it means display the member corresponding to the preference number. For instance, if preference is <code>1</code>, choice <code>d</code> would display the programmer&#8217;s job title. A sample run may look something like the following:</p>
<p class="programlistingB">Benevolent Order of Programmers Report<br/>a. display by name&#160;&#160;&#160;&#160;&#160;b. display by title<br/>c. display by bopname&#160;&#160;d. display by preference<br/>q. quit<br/>Enter your choice: <span class="EmpStrong">a</span><br/>Wimp Macho<br/>Raki Rhodes<br/>Celia Laiter<br/>Hoppy Hipman<br/>Pat Hand<br/>Next choice: <span class="EmpStrong">d</span><br/>Wimp Macho<br/>Junior Programmer<br/>MIPS<br/>Analyst Trainee<br/>LOOPY<br/>Next choice: <span class="EmpStrong">q</span><br/>Bye!</p>
<p class="question"><a id="ch06qa2q5"/><strong>5.</strong> The Kingdom of Neutronia, where the unit of currency is the tvarp, has the following income tax code:</p>
<p class="indenthandingNB">First 5,000 tvarps: 0% tax</p>
<p class="indenthandingNB">Next 10,000 tvarps: 10% tax</p>
<p class="indenthandingNB">Next 20,000 tvarps: 15% tax</p>
<p class="indenthandingNB">Tvarps after 35,000: 20% tax</p>
<p class="questionp">For example, someone earning 38,000 tvarps would owe 5,000 &#215; 0.00 + 10,000 &#215; 0.10 + 20,000 &#215; 0.15 + 3,000 &#215; 0.20, or 4,600 tvarps. Write a program that uses a loop to solicit incomes and to report tax owed. The loop should terminate when the user enters a negative number or non-numeric input.</p>
<p class="question"><a id="ch06qa2q6"/><strong>6.</strong> Put together a program that keeps track of monetary contributions to the Society for the Preservation of Rightful Influence. It should ask the user to enter the number of contributors and then solicit the user to enter the name and contribution of each contributor. The information should be stored in a dynamically allocated array of structures. Each structure should have two members: a character array (or else a <code>string</code> object) to store the name and a <code>double</code> member to hold the amount of the contribution. After reading all the data, the program should display the names and amounts donated for all donors who contributed $10,000 or more. This list should <a id="page_303"/>be headed by the label Grand Patrons. After that, the program should list the remaining donors. That list should be headed Patrons. If there are no donors in one of the categories, the program should print the word &#8220;none.&#8221; Aside from displaying two categories, the program need do no sorting.</p>
<p class="question"><a id="ch06qa2q7"/><strong>7.</strong> Write a program that reads input a word at a time until a lone <strong><code>q</code></strong> is entered. The program should then report the number of words that began with vowels, the number that began with consonants, and the number that fit neither of those categories. One approach is to use <code>isalpha()</code> to discriminate between words beginning with letters and those that don&#8217;t and then use an <code>if</code> or <code>switch</code> statement to further identify those passing the <code>isalpha()</code> test that begin with vowels. A sample run might look like this:</p>
<p class="programlistingB">Enter words (q to quit):<br/><span class="EmpStrong">The 12 awesome oxen ambled</span><br/><span class="EmpStrong">quietly across 15 meters of lawn. q</span><br/>5 words beginning with vowels<br/>4 words beginning with consonants<br/>2 others</p>
<p class="question"><a id="ch06qa2q8"/><strong>8.</strong> Write a program that opens a text file, reads it character-by-character to the end of the file, and reports the number of characters in the file.</p>
<p class="question"><a id="ch06qa2q9"/><strong>9.</strong> Do Programming Exercise 6 but modify it to get information from a file. The first item in the file should be the number of contributors, and the rest of the file should consist of pairs of lines, with the first line of each pair being a contributor&#8217;s name and the second line being a contribution. That is, the file should look like this:</p>
<p class="programlistingB">4<br/>Sam Stone<br/>2000<br/>Freida Flass<br/>100500<br/>Tammy Tubbs<br/>5000<br/>Rich Raptor<br/>55000</p>
</body>
</html>
